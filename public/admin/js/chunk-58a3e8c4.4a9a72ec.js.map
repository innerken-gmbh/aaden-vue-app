{"version":3,"sources":["webpack:///./src/model/Servant.js","webpack:///./src/model/PaymentColors.js","webpack:///./src/views/Bills/HistoryBills.vue?ec54","webpack:///./src/model/HistoryBills.js","webpack:///src/views/Bills/HistoryBills.vue","webpack:///./src/views/Bills/HistoryBills.vue?cd29","webpack:///./src/views/Bills/HistoryBills.vue"],"names":["entity","id","type","IKDataEntity","Types","Integer","displayName","tableConfig","align","form","photo","Image","formConfig","root","store","getters","rootUrl","GlobalSettings","servantRoot","requiredEdit","requiredNew","md","header","name","password","permission","Boolean","isPartTime","config","add","item","hillo","postWithUploadFile","showLoading","edit","file","imageExt","split","lastItem","remove","post","load","filter","get","lang","getLang","content","ModelFactory","list","color","getList","this","render","_vm","_h","$createElement","_c","_self","ref","staticStyle","attrs","model","dates","$t","scopedSlots","_u","key","fn","selectItems","items","staticClass","_l","n","i","billSelectionColorList","on","$event","setBillDates","_v","_s","calculateTotalPaymentPrice","toFixed","print","goNext","value","callback","$$v","showDetail","expression","currentOrderId","staticRenderFns","orderId","disableNew","disableEdit","tableName","sortable","servantName","Option","Servant","itemText","itemValue","totalPrice","payMethod","Payment","PaymentColors","merge","paymentStr","required","consumeTypeId","ConsumeType","paymentArr","multiple","disabledItem","disabled","updateTimestamp","timespan","dateFilter","join","paymentList","op","map","payLogs","forEach","paymentOriginalItem","find","p","parseInt","paymentMethodId","_langsname","amount","push","String","payItem","indexItem","totalMoney","parseFloat","component","VBtn","VCard","VDialog","VIcon","VSpacer","VToolbar","VToolbarItems"],"mappings":"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","file":"js/chunk-58a3e8c4.4a9a72ec.js","sourcesContent":["import GlobalSettings from '@/GlobalSettings'\nimport store from '../store'\nimport { IKDataEntity } from 'metaflow-js'\nimport hillo from 'hillo'\n\nconst entity = {\n  id: {\n    type: IKDataEntity.Types.Integer,\n    displayName: 'id',\n    tableConfig: {\n      align: 'start',\n    },\n    form: false,\n  },\n  photo: {\n    displayName: 'image',\n    type: IKDataEntity.Types.Image,\n    formConfig: {\n      type: {\n        root: () => store.getters.rootUrl + GlobalSettings.servantRoot,\n      },\n      requiredEdit: false,\n      requiredNew: false,\n      md: 12,\n    },\n    header: false,\n  },\n  name: {\n    displayName: 'servantName',\n  },\n  password: {\n  },\n  permission: {\n    type: IKDataEntity.Types.Boolean,\n  },\n  isPartTime: {\n    type: IKDataEntity.Types.Boolean,\n  },\n}\nconst config = {\n  add: function (item) {\n    return hillo.postWithUploadFile('Servant.php?op=add', item, {\n      showLoading: true,\n    })\n  },\n  edit: function (item) {\n    if (item.file) {\n      item.imageExt = item.file.name.split('.').lastItem\n    }\n    return hillo.postWithUploadFile('Servant.php?op=update', item, {\n      showLoading: true,\n    })\n  },\n  remove: function (id) {\n    return hillo.post('Servant.php?op=delete', { id: id })\n  },\n  load: async function (filter) {\n    return (await hillo.get('Servant.php', { lang: GlobalSettings.getLang(), ...filter }))\n      .content\n  },\n}\n\nexport default IKDataEntity.ModelFactory(entity, config)\n","export default {\n  list: [\n    {\n      id: -11,\n      color: 'brown lighten-5',\n    }, {\n      id: -10,\n      color: 'deep-orange lighten-5',\n    },\n    {\n      id: 0,\n      color: 'error',\n    },\n    {\n      id: 1,\n      color: 'primary',\n    }, {\n      id: 2,\n      color: 'success',\n    }, {\n      id: 3,\n      color: 'warning',\n    }, {\n      id: 4,\n      color: 'secondary',\n    }, {\n      id: 5,\n      color: 'accent',\n    }, {\n      id: 6,\n      color: 'tertiary',\n    }, {\n      id: 7,\n      color: 'info',\n    }, {\n      id: 8,\n      color: 'pink',\n    }, {\n      id: 9,\n      color: 'cyan',\n    }, {\n      id: 10,\n      color: 'deep-purple lighten-4',\n    }, {\n      id: 11,\n      color: 'lime',\n    }, {\n      id: 12,\n      color: 'light-green',\n    }, {\n      id: 13,\n      color: 'amber',\n    }, {\n      id: 14,\n      color: 'yellow',\n    }, {\n      id: 15,\n      color: 'deep-orange',\n    }, {\n      id: 16,\n      color: 'blue lighten-4',\n    }, {\n      id: 17,\n      color: 'blue-grey',\n    }, {\n      id: 18,\n      color: 'yellow darken-4',\n    }, {\n      id: 19,\n      color: 'brown lighten-5',\n    }, {\n      id: 20,\n      color: 'deep-orange lighten-5',\n    },\n  ],\n  getList: function () {\n    return this.list\n  },\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('ik-data-table',{ref:\"billTable\",staticStyle:{\"width\":\"100%\"},attrs:{\"use-default-action\":false,\"model\":_vm.model,\"required-date-value\":_vm.dates,\"entity-name\":_vm.$t('全部账单'),\"use-select\":false,\"use-customer-action-only\":true,\"icon\":'mdi-format-list-bulleted',\"use-date-filter\":true},scopedSlots:_vm._u([{key:\"footer\",fn:function(ref){\nvar selectItems = ref.selectItems;\nvar items = ref.items;\nreturn [_c('div',{staticClass:\"d-flex pa-2\"},[_vm._l((_vm.billSelectionList),function(n,i){return [_c('v-btn',{key:i,staticClass:\"mr-1\",attrs:{\"color\":_vm.billSelectionColorList[i],\"dark\":\"\",\"outlined\":\"\",\"small\":\"\"},on:{\"click\":function($event){return _vm.setBillDates(i)}}},[_vm._v(\" \"+_vm._s(n)+\" \")])]}),_c('v-btn',{staticClass:\"ml-1\",attrs:{\"small\":\"\",\"color\":\"green\"}},[_vm._v(\" \"+_vm._s(_vm.$t('sumAmount'))+\"：€\"+_vm._s(_vm.calculateTotalPaymentPrice().toFixed(2))+\" \")]),_c('v-btn',{staticClass:\"primary\",attrs:{\"small\":\"\"},on:{\"click\":_vm.print}},[_vm._v(\" \"+_vm._s(_vm.$t('打印'))+\" \")])],2)]}},{key:\"item.action\",fn:function(ref){\nvar item = ref.item;\nreturn [_c('v-icon',{staticClass:\"mr-2\",attrs:{\"small\":\"\"},on:{\"click\":function($event){return _vm.goNext(item)}}},[_vm._v(\" mdi-arrow-right \")])]}}])}),_c('v-dialog',{attrs:{\"fullscreen\":\"\"},model:{value:(_vm.showDetail),callback:function ($$v) {_vm.showDetail=$$v},expression:\"showDetail\"}},[_c('v-card',{attrs:{\"color\":\"#f6f6f6\"}},[_c('v-toolbar',{attrs:{\"dense\":\"\"}},[_c('v-spacer'),_c('v-toolbar-items',{staticClass:\"mr-n4\"},[_c('v-btn',{attrs:{\"color\":\"error\"},on:{\"click\":function($event){_vm.showDetail=false}}},[_c('v-icon',{attrs:{\"color\":\"white\",\"left\":\"\"}},[_vm._v(\" mdi-close \")]),_c('span',{staticStyle:{\"font-size\":\"24px\"}},[_vm._v(\"Zurück\")])],1)],1)],1),_c('bill-detail-page',{attrs:{\"id\":_vm.currentOrderId}})],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import GlobalSettings from '@/GlobalSettings'\n\nimport { IKDataEntity } from 'metaflow-js'\nimport hillo from 'hillo'\nimport ConsumeType from './ConsumeType'\nimport Payment from './Payment'\nimport PaymentColors from './PaymentColors'\nimport Servant from '@/model/Servant'\n\nconst entity = {\n  orderId: {\n    type: IKDataEntity.Types.Integer,\n    displayName: 'id',\n    tableConfig: {\n      align: 'start',\n    },\n    formConfig: {\n      disableNew: true,\n      disableEdit: true,\n      requiredNew: false,\n    },\n  },\n  tableName: {\n    tableConfig: {\n      sortable: true,\n    },\n  },\n  servantName: {\n    type: IKDataEntity.Types.Option,\n    formConfig: {\n      type: {\n        selectItems: Servant.getList,\n        itemText: 'name',\n        itemValue: 'name',\n      },\n    },\n    displayName: 'servantName',\n  },\n\n  totalPrice: {\n    tableConfig: {\n      sortable: true,\n    },\n  },\n  payMethod: {\n    type: IKDataEntity.Types.Option,\n    formConfig: {\n      type: {\n        selectItems: Payment.getList,\n        itemText: '_langsname',\n        color: PaymentColors.getList(),\n      },\n      merge: false,\n    },\n    displayName: '付款状态',\n\n  },\n  paymentStr: {\n    formConfig: {\n      required: false,\n    },\n    displayName: 'payMethod',\n  },\n  consumeTypeId: {\n    type: IKDataEntity.Types.Option,\n    formConfig: {\n      type: {\n        selectItems: ConsumeType.getList,\n      },\n    },\n  },\n  paymentArr: {\n    displayName: 'payMethod',\n    type: IKDataEntity.Types.Option,\n    header: false,\n    formConfig: {\n      required: false,\n      type: {\n        selectItems: Payment.getList,\n        // itemText: '_langsname',\n        multiple: true,\n        disabledItem: (item) => {\n          if (item.id === 0) {\n            return ({\n              ...item,\n              disabled: item,\n            })\n          } else {\n            return item\n          }\n        },\n      },\n    },\n  },\n  updateTimestamp: {\n    displayName: '结账时间',\n  },\n}\n\nconst config = {\n  load: async function (filter) {\n    const timespan = filter[0].dateFilter.join(' - ')\n    const paymentList = await Payment.getList()\n    const list = (await hillo.get('Orders.php', {\n      op: 'withSortAndFilter',\n      lang: GlobalSettings.getLang(),\n      timespan: timespan,\n    })).content\n\n    return list.map(function (item) {\n      if (item.payLogs) {\n        item.paymentStr = []\n        item.paymentArr = []\n        item.payLogs.forEach(n => {\n          n.paymentOriginalItem = paymentList.find(p => p.id === parseInt(n.paymentMethodId))\n          if (n.paymentMethodId !== '9') {\n            let paymentStr = ''\n            if (n.paymentOriginalItem) {\n              paymentStr = n.paymentOriginalItem._langsname + ':' + n.amount\n            }\n            item.paymentStr.push(paymentStr)\n            item.paymentArr.push(n.paymentMethodId)\n          }\n        })\n        item.paymentStr = item.paymentStr.join(' / ')\n        item.paymentArr = String(item.paymentArr)\n      }\n      item.id = item.orderId\n      return item\n    })\n  },\n}\nexport default IKDataEntity.ModelFactory(entity, config)\n","<template>\n  <div>\n    <ik-data-table\n      ref=\"billTable\"\n      :use-default-action=\"false\"\n      :model=\"model\"\n      :required-date-value=\"dates\"\n      :entity-name=\"$t('全部账单')\"\n      style=\"width: 100%\"\n      :use-select=\"false\"\n      :use-customer-action-only=\"true\"\n      :icon=\"'mdi-format-list-bulleted'\"\n      :use-date-filter=\"true\"\n    >\n      <template #footer=\"{selectItems,items}\">\n        <div class=\"d-flex pa-2\">\n          <template v-for=\"(n, i) in billSelectionList\">\n            <v-btn\n              :key=\"i\"\n              class=\"mr-1\"\n              :color=\"billSelectionColorList[i]\"\n              dark\n              outlined\n              small\n              @click=\"setBillDates(i)\"\n            >\n              {{ n }}\n            </v-btn>\n          </template>\n\n          <v-btn\n            class=\"ml-1\"\n            small\n            color=\"green\"\n          >\n            {{ $t('sumAmount') }}：€{{ calculateTotalPaymentPrice().toFixed(2) }}\n          </v-btn>\n          <v-btn\n            small\n            class=\"primary\"\n            @click=\"print\"\n          >\n            {{ $t('打印') }}\n          </v-btn>\n        </div>\n      </template>\n      <template #item.action=\"{ item }\">\n        <v-icon\n          class=\"mr-2\"\n          small\n          @click=\"goNext(item)\"\n        >\n          mdi-arrow-right\n        </v-icon>\n      </template>\n    </ik-data-table>\n    <v-dialog\n      v-model=\"showDetail\"\n      fullscreen\n    >\n      <v-card color=\"#f6f6f6\">\n        <v-toolbar\n          dense\n        >\n          <v-spacer/>\n          <v-toolbar-items class=\"mr-n4\">\n            <v-btn\n              color=\"error\"\n              @click=\"showDetail=false\"\n            >\n              <v-icon\n                color=\"white\"\n                left\n              >\n                mdi-close\n              </v-icon>\n              <span style=\"font-size: 24px\">Zurück</span>\n            </v-btn>\n          </v-toolbar-items>\n        </v-toolbar>\n        <bill-detail-page :id=\"currentOrderId\"/>\n      </v-card>\n    </v-dialog>\n  </div>\n</template>\n\n<script>\n\n  import { printSummaryBon } from '@/components/Utlis/api'\n  import IKUtils from 'innerken-js-utils'\n  import HistoryBills from '../../model/HistoryBills'\n  import { IkDataTable } from 'metaflow-js'\n  // import moment from 'moment'\n  import BillDetailPage from '../Details/BillDetailPage'\n  import dayjs from 'dayjs'\n\n  export default {\n    components: {\n      BillDetailPage,\n      IkDataTable,\n    },\n    data: function () {\n      return ({\n\n        model: HistoryBills,\n        dates: [dayjs().format('YYYY-MM-DD'), dayjs().format('YYYY-MM-DD')],\n        timer: null,\n        showDetail: null,\n        currentOrderId: null,\n        menu: false,\n        modal: false,\n        menu2: false,\n        billSelectionList: [\n          this.$i18n.t('当日结单'),\n          this.$i18n.t('本周结单'),\n          this.$i18n.t('本月结单'),\n        ],\n        billSelectionColorList: ['green darken-2', 'blue darken-2', 'purple darken-2', 'pink'],\n      })\n    },\n    async mounted () {\n      this.dates = [dayjs().format('YYYY-MM-DD'), dayjs().format('YYYY-MM-DD')]\n    },\n    methods: {\n      calculateTotalPrice (items) {\n        return items ? items.reduce(\n          (arr, item) =>\n            item.consumeTypeStatusId !== 5 ? arr + parseFloat(item.totalPrice) : arr\n          , 0) : 0\n      },\n      calculateTotalPaymentPrice () {\n        const items = this.$refs.billTable.tableItem\n        if (!this.$refs.billTable || !this.$refs.billTable.filterItem.paymentArr ||\n          (this.$refs.billTable.filterItem.paymentArr.length === 0)) {\n          return items ? items.reduce(\n            (arr, item) =>\n              item.consumeTypeStatusId !== 5 ? arr + parseFloat(item.totalPrice) : arr\n            , 0) : 0\n        } else {\n          const paymentArr = this.$refs.billTable.filterItem.paymentArr\n          let totalMoney = 0\n          paymentArr.forEach(indexItem => {\n            for (const item of items) {\n              if (item.payLogs !== null) {\n                item.payLogs.forEach(payItem => {\n                  if (parseInt(payItem.paymentMethodId) === parseInt(indexItem)) {\n                    totalMoney += parseFloat(payItem.amount)\n                  }\n                })\n              }\n            }\n          })\n          return totalMoney\n        }\n      },\n      goNext (item) {\n        this.showDetail = true\n        this.currentOrderId = item.orderId\n      },\n      setBillDates (i) {\n        switch (i) {\n          case 0:\n            this.dates = [dayjs().format('YYYY-MM-DD'), dayjs().format('YYYY-MM-DD')]\n            break\n          case 1:\n            this.dates = [dayjs().startOf('week').format('YYYY-MM-DD'), dayjs().format('YYYY-MM-DD')]\n            break\n          case 2:\n            this.dates = [dayjs().startOf('month').format('YYYY-MM-DD'), dayjs().format('YYYY-MM-DD')]\n            break\n          case 3:\n            this.dates = [dayjs().startOf('year').format('YYYY-MM-DD'), dayjs().format('YYYY-MM-DD')]\n        }\n      },\n\n      print () {\n        // console.log('this.dates.', this.dates)\n        const timeSpan = { timespan: this.$refs.billTable.okDates.join(' - ') }\n        IKUtils.showConfirm('Bist du sicher?', 'Möchten Sie alle Datensätze drucken?', () => {\n          printSummaryBon(timeSpan).then(() => {\n            IKUtils.toast('Erfolgreich drucken!')\n          })\n        })\n      },\n\n    },\n  }\n</script>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./HistoryBills.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./HistoryBills.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./HistoryBills.vue?vue&type=template&id=30b14192&\"\nimport script from \"./HistoryBills.vue?vue&type=script&lang=js&\"\nexport * from \"./HistoryBills.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VDialog } from 'vuetify/lib/components/VDialog';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\nimport { VSpacer } from 'vuetify/lib/components/VGrid';\nimport { VToolbar } from 'vuetify/lib/components/VToolbar';\nimport { VToolbarItems } from 'vuetify/lib/components/VToolbar';\ninstallComponents(component, {VBtn,VCard,VDialog,VIcon,VSpacer,VToolbar,VToolbarItems})\n"],"sourceRoot":""}