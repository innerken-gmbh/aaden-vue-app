(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3c35ad2d"],{4497:function(t,e,a){"use strict";a("4de4"),a("d81d"),a("96cf");var i=a("1da1"),n=a("633c"),s=a("6306"),r=a("9225"),o={list:[{id:1,name:r["a"].t("Others")},{id:2,name:r["a"].t("RechnungBon")},{id:3,name:r["a"].t("Zbon")},{id:4,name:r["a"].t("KitchenBon")}],getList:function(){return this.list}},c={list:[{id:0,name:r["a"].t("打印失败")},{id:1,name:r["a"].t("打印成功")},{id:2,name:r["a"].t("验证错误")},{id:3,name:r["a"].t("单子格式不合规范")},{id:4,name:r["a"].t("正在打印")},{id:5,name:r["a"].t("网络错误")}],getList:function(){return this.list}},l={id:{type:n["a"].Types.Integer,displayName:"id",tableConfig:{align:"start"}},printStatus:{displayName:"printStatus",type:n["a"].Types.Option,formConfig:{type:{selectItems:c.getList(),itemText:"name"}}},addTimeStamp:{displayName:"addTimeStamp"},printBonClass:{type:n["a"].Types.Option,formConfig:{type:{selectItems:o.getList()}}},printerGroupId:{type:n["a"].Types.Option,formConfig:{type:{selectItems:s["a"].getList}}},printerMsg:{displayName:"printerMsg"},content:{displayName:"checkContent",header:!1}},d={load:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,n["e"].get("PrintRecord.php",{op:"getAllRecords"});case 2:if(a=t.sent.content.map((function(t){return n["a"].parseDataForEntity(t,l)})),e=e[0],!e){t.next=6;break}return t.abrupt("return",a.filter((function(t){return t.printStatus[0]!==e.printStatus})));case 6:return t.abrupt("return",a);case 7:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}(),reprint:function(t){return n["e"].get("Printer.php?op=reprintWithDefault",{id:t.id})}};e["a"]=n["a"].ModelFactory(l,d)},"5c3a8":function(t,e,a){"use strict";a.r(e),a.d(e,"getPrintList",(function(){return b}));var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{id:"dashboard",fluid:"",tag:"section"}},[a("v-row",[a("v-col",{attrs:{cols:"12",md:"12"}},[a("v-card",{attrs:{color:"basil"}},[a("v-card-title",{staticClass:"text-center justify-center py-6"},[a("h1",{staticClass:"font-weight-bold display-3 basil--text"},[t._v(" "+t._s(t.restaurantName)+" ")])]),a("v-tabs",{attrs:{"background-color":"transparent",color:"basil",grow:""}},[t._l(t.items,(function(e,i){return a("v-tab",{key:i},[t._v(" "+t._s(e)+" ")])})),a("v-tab-item",[a("base-material-card",{staticClass:"px-5 py-3",attrs:{id:"coloured-line",color:"warning",icon:"mdi-chart-timeline-variant"},scopedSlots:t._u([{key:"after-heading",fn:function(){return[a("div",{staticClass:"display-1 font-weight-light mt-2"},[t._v(" "+t._s(t.$t("销售数据统计"))+" ")])]},proxy:!0}])},[a("chartist",{staticClass:"mt-3",staticStyle:{"max-height":"300px"},attrs:{data:t.salesData,options:t.salesDataChart.options,type:"Line"}}),a("v-divider",{staticClass:"ma-3"}),a("div",{staticClass:"px-3"},[a("div",{staticClass:"body-2 text-uppercase grey--text font-weight-bold mb-3"},[t._v(" Legend ")]),a("v-row",{staticClass:"ma-0",attrs:{align:"center"}},[a("v-avatar",{staticClass:"mr-1",attrs:{color:"info",size:"12"}}),a("span",{staticClass:"mr-3 font-weight-light"},[t._v(t._s(t.$t("Food")))]),a("v-avatar",{staticClass:"mr-1",attrs:{color:"red",size:"12"}}),a("span",{staticClass:"mr-3 font-weight-light"},[t._v(t._s(t.$t("Drinks")))])],1)],1)],1)],1),a("v-tab-item",[a("base-material-card",{staticClass:"px-5 py-3",attrs:{color:"red",icon:"mdi-truck",small:"",inline:""},scopedSlots:t._u([{key:"after-heading",fn:function(){return[a("div",{staticClass:"display-1 font-weight-light mt-2"},[t._v(" "+t._s(t.$t("等待处理的外卖订单"))+" ")])]},proxy:!0}])},[a("v-card-text",[a("v-data-table",{attrs:{headers:t.headers,items:t.desserts,"items-per-page":5,"sort-desc":["id"],"sort-by":["id"],"show-expand":"","multi-sort":""},scopedSlots:t._u([{key:"item.action",fn:function(e){var i=e.item;return[parseInt(i.consumeTypeStatusId)<2?[t._l([0,30,60,90],(function(e){return[a("v-chip",{key:e,staticClass:"mx-2",attrs:{color:"green","text-color":"white"},on:{click:function(a){return t.acceptOrder(i,e)}}},[t._v(" + "+t._s(e)+" MIN ")])]})),a("v-chip",{staticClass:"mr-2",attrs:{color:"red","text-color":"white"},on:{click:function(e){return t.rejectOrder(i)}}},[t._v(" "+t._s(t.$t("拒绝订单"))+" "),a("v-icon",{attrs:{small:"",right:""}},[t._v(" mdi-close-circle ")])],1)]:t._e(),void 0,a("v-chip",{staticClass:"mr-2",on:{click:function(e){return t.goNext(i)}}},[t._v(" "+t._s(t.$t("查看详情"))+" "),a("v-icon",{attrs:{small:"",right:""}},[t._v(" mdi-arrow-right ")])],1)]}},{key:"item.payMethod",fn:function(e){var a=e.item;return[t._v(" "+t._s(t.payMethods.find((function(t){return a.payMethod===t.id})).name)+" ")]}},{key:"item.consumeTypeStatusId",fn:function(e){var a=e.item;return[t._v(" "+t._s(t.statusText(a))+" ")]}},{key:"expanded-item",fn:function(e){var i=e.item;return[a("td",{attrs:{colspan:t.headers.length+1}},[a("v-card",{staticStyle:{width:"100%"}},[a("v-card-title",[t._v(t._s(t.$t("详细信息")))]),a("v-card-text",[a("v-row",[a("v-col",{attrs:{cols:"12",md:"6"}},[a("address-info-block",{attrs:{"address-info":JSON.parse(i.rawAddressInfo)}})],1),a("v-col",{attrs:{cols:"12",md:"6"}},[a("dish-info-block",{attrs:{"dish-orders":i.details}})],1)],1)],1)],1)],1)]}}])})],1)],1)],1),a("v-tab-item",[a("ik-data-table",{attrs:{model:t.model,"use-default-action":!1,"use-select":!1,"show-expand":!0,"single-expand":!0,filter:{printStatus:1},icon:"mdi-clipboard-list","items-per-page":5,"entity-name":t.$t("打印单列表")},scopedSlots:t._u([{key:"expanded-item",fn:function(e){var i=e.item;return[a("div",{staticClass:"text-center",domProps:{innerHTML:t._s(i.content)}})]}},{key:"footer",fn:function(){return[a("v-toolbar",{attrs:{color:"white",flat:""}})]},proxy:!0},{key:"item.action",fn:function(e){var i=e.item;return[a("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(e){return t.reprint(i)}}},[t._v(" mdi-printer ")])]}}])})],1),a("v-tab-item",[a("base-material-card",{staticClass:"px-5 py-3",attrs:{color:"primary",icon:"mdi-account",inline:""},scopedSlots:t._u([{key:"after-heading",fn:function(){return[a("div",{staticClass:"display-1 font-weight-light mt-2"},[t._v(" "+t._s(t.$t("随时更新，随时掌握营销状况"))+" ")])]},proxy:!0}])},[a("v-card-text",[a("v-data-table",{attrs:{headers:t.servantHeader,items:t.thisMonthServantRank},scopedSlots:t._u([{key:"item.photo",fn:function(e){var i=e.item;return[a("v-avatar",{attrs:{tile:""}},[a("v-img",{attrs:{src:t.servantImgRoot+i.photo,height:"48px",width:"48px"}})],1)]}}])})],1)],1)],1),a("v-tab-item",[a("v-row",[a("v-col",{attrs:{cols:"12",md:"8"}},[a("base-material-card",{staticClass:"px-5 py-3",attrs:{color:"pink",icon:"mdi-heart",inline:""},scopedSlots:t._u([{key:"after-heading",fn:function(){return[a("div",{staticClass:"display-1 font-weight-light mt-2"},[t._v(" "+t._s(t.$t("本周内最受欢迎的精美食品"))+" ")])]},proxy:!0}])},[a("v-card-text",[a("v-data-table",{attrs:{headers:t.dishesHeader,items:t.thisWeekMostPopularDishes},scopedSlots:t._u([{key:"item.photo",fn:function(e){var i=e.item;return[a("v-avatar",{attrs:{tile:""}},[a("v-img",{attrs:{src:t.dishImgRoot+i.image,height:"48px",width:"48px"}})],1)]}}])})],1)],1)],1),a("v-col",{attrs:{cols:"12",md:"4"}},[a("v-card",[a("v-card-title",{staticClass:"subheading font-weight-bold"},[t._v(" "+t._s(t.$t("热销菜品分布"))+" ")]),a("v-divider"),a("v-list",{attrs:{dense:""}},t._l(t.indexData.thisMonthIncomePieChart,(function(e,i){return a("v-list-item",{key:i},[a("v-list-item-content",[t._v(" "+t._s(t.indexData.thisMonthIncomePieChart[i].name)+": ")]),a("v-list-item-content",[t._v(" "+t._s(t.indexData.thisMonthIncomePieChart[i].sumPrice)+" ")])],1)})),1)],1)],1)],1),t._v(" > ")],1)],2)],1)],1)],1),a("v-row",[a("v-col",{attrs:{lg:"3",cols:"12"}},[a("base-material-card",{attrs:{color:"error",icon:"mdi-run-fast",title:t.$t("快速操作")}},[a("v-list",[a("v-list-item",{on:{click:t.toZbon}},[a("v-list-item-icon",[a("v-icon",[t._v(" mdi-format-list-bulleted ")])],1),a("v-list-item-content",[a("v-list-item-title",[t._v(" "+t._s(t.$t("Zbon列表"))+" ")])],1)],1),a("v-list-item",{on:{click:t.toAllBills}},[a("v-list-item-icon",[a("v-icon",[t._v(" mdi-calendar-account ")])],1),a("v-list-item-content",[a("v-list-item-title",[t._v(" "+t._s(t.$t("全部账单"))+" ")])],1)],1),a("v-list-item",{on:{click:t.addDishes}},[a("v-list-item-icon",[a("v-icon",[t._v(" mdi-pencil ")])],1),a("v-list-item-content",[a("v-list-item-title",[t._v(" "+t._s(t.$t("菜品管理"))+" ")])],1)],1),a("v-list-item",{on:{click:t.addCategories}},[a("v-list-item-icon",[a("v-icon",[t._v(" mdi-domain ")])],1),a("v-list-item-content",[a("v-list-item-title",[t._v(" "+t._s(t.$t("标签管理"))+" ")])],1)],1),a("v-list-item",{on:{click:t.dishStatistic}},[a("v-list-item-icon",[a("v-icon",[t._v(" mdi-dialpad ")])],1),a("v-list-item-content",[a("v-list-item-title",[t._v(" "+t._s(t.$t("菜品统计"))+" ")])],1)],1),a("v-list-item",{on:{click:t.dailyBill}},[a("v-list-item-icon",[a("v-icon",[t._v(" mdi-bulletin-board ")])],1),a("v-list-item-content",[a("v-list-item-title",[t._v(" "+t._s(t.$t("本日总汇"))+" ")])],1)],1)],1)],1)],1),[a("v-col",{attrs:{lg:"9",cols:"12"}},[a("v-row",[a("v-col",{attrs:{cols:"12",md:"6"}},[a("base-material-stats-card",{attrs:{color:"info",icon:"mdi-twitter","sub-icon":"mdi-clock","sub-text":t.$t("Just Updated"),title:t.$t("今日营业总额"),value:"€"+t.todayInfo.sumIncome}})],1),a("v-col",{attrs:{cols:"12",md:"6"}},[a("base-material-stats-card",{attrs:{color:"primary",icon:"mdi-poll","sub-icon":"mdi-tag","sub-text":t.$t("Tracked from Aaden Analytics"),title:t.$t("今日用餐总人数"),value:t.todayInfo.sumPersonCount}})],1),a("v-col",{attrs:{cols:"12",md:"6"}},[a("base-material-stats-card",{attrs:{color:"success",icon:"mdi-store","sub-icon":"mdi-calendar","sub-text":"",title:t.$t("使用中的桌子"),value:t.tableUsageStatus.inUse}})],1),a("v-col",{attrs:{cols:"12",md:"6"}},[a("base-material-stats-card",{attrs:{color:"orange",icon:"mdi-sofa","sub-icon":"mdi-alert",title:t.$t("本月平均翻台率"),"sub-text":t.$t("翻台率是指桌子被使用的频率"),value:t.tableRenew.toFixed(2)+"%"}})],1)],1)],1)]],2)],1)},n=[],s=(a("7db0"),a("c975"),a("a15b"),a("13d5"),a("b0c0"),a("ac1f"),a("1276"),a("96cf"),a("1da1")),r=a("b85c"),o=a("0a61"),c=a("3405"),l=a("f683"),d=a("4907"),u=a("ccdd"),m=a("0144"),h=a("c1df"),p=a.n(h),v=a("633c"),f=a("9225"),g=a("4497"),y={name:"DashboardDashboard",components:{DishInfoBlock:d["default"],AddressInfoBlock:l["default"],IkDataTable:v["c"]},data:function(){return{timer1:null,timer2:null,items:[this.$i18n.t("销售数据统计"),this.$i18n.t("外卖订单"),this.$i18n.t("错误打印单列表"),this.$i18n.t("跑堂排行"),this.$i18n.t("本周热销菜品")],salesDataChart:{options:{low:0,chartPadding:{top:0,right:0,bottom:0,left:0}}},servantHeader:[{text:"Name",value:"name"},{text:this.$i18n.t("income"),value:"income",align:"right"},{text:this.$i18n.t("billCount"),value:"billCount",align:"right"}],dishesHeader:[{text:this.$i18n.t("Ranking"),value:"rank"},{text:this.$i18n.t("image"),value:"photo",align:"center"},{text:this.$i18n.t("name"),value:"name",align:"right"},{text:this.$i18n.t("price"),value:"price",align:"right"},{text:this.$i18n.t("count"),value:"sumCount",align:"right"}],indexData:{sevenDaysFoodDrinkIncome:[],thisMonthServantRank:[],todayInfo:{sumIncome:"0"},tableUsageStatus:{inUse:"0"},thisMonthAverageTablesRenewRate:0},headers:[{text:"Id",align:"start",value:"id"},{text:this.$i18n.t("下单时间"),value:"createTimestamp"},{text:this.$i18n.t("totalPrice"),value:"totalPrice"},{text:this.$i18n.t("payMethod"),value:"payMethod"},{text:this.$i18n.t("consumeTypeStatus"),value:"consumeTypeStatusId"},{text:this.$i18n.t("action"),value:"action",sortable:!1}],model:g["a"],desserts:[],payMethods:[],printList:[],consumeTypeStatusList:[],restaurantName:""}},computed:{filter:function(){return function(t){return"1"!==t.printStatus}},servantImgRoot:function(){return this.$store.getters.rootUrl+c["a"].servantRoot},dishImgRoot:function(){return this.$store.getters.rootUrl+c["a"].dishImageRoot},salesData:function(){var t,e=[],a=[],i=[],n=Object(r["a"])(this.indexData.sevenDaysFoodDrinkIncome);try{for(n.s();!(t=n.n()).done;){var s=t.value,o=s.find((function(t){return"foods"===t.name.toLowerCase()})),c=s.find((function(t){return"drinks"===t.name.toLowerCase()}));e.push(o.dateDisplay),a.push(o.income),i.push(c.income)}}catch(l){n.e(l)}finally{n.f()}return{labels:e.reverse(),series:[a.reverse(),i.reverse()]}},thisMonthServantRank:function(){return this.indexData.thisMonthServantRank},todayInfo:function(){return this.indexData.todayInfo},tableUsageStatus:function(){return this.indexData.tableUsageStatus},tableRenew:function(){return this.indexData.thisMonthAverageTablesRenewRate},thisWeekMostPopularDishes:function(){return this.indexData.thisWeekMostPopularDishes},totalSales:function(){return this.sales.reduce((function(t,e){return t+e.salesInM}),0)}},created:function(){this.onceData(),this.reloadData(),this.reloadItem(),this.timer2=setInterval(this.reloadItem,3e4),this.$once("hook:beforeDestroy",(function(){}))},beforeDestroy:function(){clearInterval(this.timer2)},methods:{reprint:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,e.model.reprint(t);case 2:v["b"].toast();case 3:case"end":return a.stop()}}),a)})))()},toZbon:function(){this.$router.push({path:"/Bills/zbonlist"})},toAllBills:function(){this.$router.push({path:"/Bills/history-bills"})},addDishes:function(){this.$router.push({path:"/dishes/dishes-manage"})},addCategories:function(){this.$router.push({path:"/dishes/labels-manage"})},dishStatistic:function(){this.$router.push({path:"/dishes/dish-statistics"})},dailyBill:function(){this.$router.push({path:"/Bills/today-bills"})},statusText:function(t){return 1===parseInt(t.consumeTypeStatusId)?(console.log(["1","2","3"].indexOf(t.payMethod)),-1!==["1","2","3"].indexOf(t.payMethod)?"Unbezahlt":"Bezahlt"):this.consumeTypeStatusList.find((function(e){return t.consumeTypeStatusId===e.id})).name},acceptOrder:function(t,e){var a=this,i=JSON.parse(t.rawAddressInfo),n=p()();return i&&i.date&&i.time&&(n=p()(i.date+" "+i.time,"DD.MM.YYYY HH:mm")),n.add(e,"m"),m["a"].post("Orders.php?op=acceptTakeawayOrder",{tableId:t.tableId,reason:n.format("DD-MM-YYYY HH:mm")}).then((function(t){console.log(t),a.reloadItem()}))},rejectOrder:function(t){v["e"].fastSweetAlertRequest(this.$i18n.t("请输入拒绝接单的理由"),"text","Orders.php?op=rejectTakeAwayOrder","reason",{tableId:t.tableId},this.reloadItem)},goNext:function(t){this.$router.push({name:"Seite mit den Rechnungsdetails",params:{id:t.id}})},onceData:function(){var t=this;Object(o["h"])().then((function(e){t.payMethods=e.content,t.formatItem()})),Object(o["k"])().then((function(e){t.consumeTypeStatusList=e.content})),b().then((function(e){var a,i=Object(r["a"])(e.content);try{for(i.s();!(a=i.n()).done;){var n=a.value;"1"!==n.printStatus&&t.printList.push(n)}}catch(s){i.e(s)}finally{i.f()}})),Object(o["p"])().then((function(e){var a=[];a=e.content[0].name.split("<BR>"),t.restaurantName=a.join(" "),console.log("====="+t.restaurantName)}))},findLangInArray:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f["a"].locale;return t.find((function(t){return t.lang.toLowerCase()===e.toLowerCase()}))},formatItem:function(){var t,e=Object(r["a"])(this.payMethods);try{for(e.s();!(t=e.n()).done;){var a=t.value;a.name=this.findLangInArray(a.langs).name}}catch(i){e.e(i)}finally{e.f()}},reloadData:function(){var t=this;Object(o["n"])().then((function(e){t.indexData=e}))},reloadItem:function(){var t=this;this.loading=!0,Object(o["r"])().then((function(e){t.desserts.length>0&&e.content.length>t.desserts.length&&u["a"].play(),t.desserts=e.content,t.loading=!1}))},beforeDestroy:function(){clearTimeout(this.timer1),clearTimeout(this.timer2),this.timer1=null,this.timer2=null},complete:function(t){this.list[t]=!this.list[t]}}},b=function(t){return m["a"].get("PrintRecord.php?op=getAllRecords",{id:t})},x=y,_=(a("674b"),a("2877")),k=a("6544"),w=a.n(k),I=a("8212"),C=a("b0af"),$=a("99d9"),S=a("cc20"),D=a("62ad"),T=a("a523"),M=a("8fea"),R=a("ce7e"),O=a("132d"),L=a("adda"),P=a("8860"),N=a("da13"),V=a("5d23"),j=a("34c3"),A=a("0fd9"),B=a("71a3"),U=a("c671"),F=a("fe57"),H=a("71d9"),Y=Object(_["a"])(x,i,n,!1,null,null,null);e["default"]=Y.exports;w()(Y,{VAvatar:I["a"],VCard:C["a"],VCardText:$["c"],VCardTitle:$["d"],VChip:S["a"],VCol:D["a"],VContainer:T["a"],VDataTable:M["a"],VDivider:R["a"],VIcon:O["a"],VImg:L["a"],VList:P["a"],VListItem:N["a"],VListItemContent:V["a"],VListItemIcon:j["a"],VListItemTitle:V["c"],VRow:A["a"],VTab:B["a"],VTabItem:U["a"],VTabs:F["a"],VToolbar:H["a"]})},6306:function(t,e,a){"use strict";a("d81d");var i=a("5530"),n=(a("96cf"),a("1da1")),s=a("633c"),r={id:{type:s["a"].Types.Integer,displayName:"id",tableConfig:{align:"start"},form:!1},name:{displayName:"sectionName"},isSingleLinePrint:{type:s["a"].Types.Boolean,displayName:"isSingleLinePrint"},isSingleOrderPrint:{type:s["a"].Types.Boolean,displayName:"isSingleOrderPrint"},printerCount:{displayName:"printerCount",formConfig:{inEdit:!1,inNew:!1}}},o={load:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,s["e"].get("Printer.php",Object(i["a"])({op:"showPrinterGroups"},e));case 2:return t.abrupt("return",t.sent.content.map((function(t){return s["a"].parseDataForEntity(t,r)})));case 3:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}(),add:function(t){return s["e"].postWithUploadFile("Printer.php?op=addPrinterGroups",t,{showLoading:!0})},edit:function(t){return s["e"].postWithUploadFile("Printer.php?op=updatePrinterGroups",t,{showLoading:!0})},remove:function(t){return s["e"].post("Printer.php?op=deletePrinterGroup",{id:t})}};e["a"]=s["a"].ModelFactory(r,o)},"674b":function(t,e,a){"use strict";var i=a("d1f7"),n=a.n(i);n.a},d1f7:function(t,e,a){}}]);
//# sourceMappingURL=chunk-3c35ad2d.d0db8e0e.js.map