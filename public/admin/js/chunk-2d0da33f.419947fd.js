(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0da33f"],{"6b30":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{fluid:""}},[a("base-material-card",{staticClass:"px-5 py-3",attrs:{color:"red",icon:"mdi-truck",small:"",inline:""},scopedSlots:t._u([{key:"after-heading",fn:function(){return[a("div",{staticClass:"display-1 font-weight-light mt-2"},[t._v(" "+t._s(t.$t("外卖单列表"))+" ")])]},proxy:!0}])},[a("v-card-text",[a("v-data-table",{attrs:{headers:t.headers,items:t.desserts,loading:t.loading,"items-per-page":5,"sort-desc":["id"],"sort-by":["id"],"show-expand":"","multi-sort":""},scopedSlots:t._u([{key:"item.action",fn:function(e){var n=e.item;return[parseInt(n.consumeTypeStatusId)<2?[t._l([0,30,60,90],(function(e){return[a("v-chip",{key:e,staticClass:"mx-2",attrs:{color:"green","text-color":"white"},on:{click:function(a){return t.acceptOrder(n,e)}}},[t._v(" + "+t._s(e)+" MIN ")])]})),a("v-chip",{staticClass:"mr-2",attrs:{color:"red","text-color":"white"},on:{click:function(e){return t.rejectOrder(n)}}},[t._v(" "+t._s(t.$t("拒绝订单"))+" "),a("v-icon",{attrs:{small:"",right:""}},[t._v(" mdi-close-circle ")])],1)]:t._e(),void 0,a("v-chip",{staticClass:"mr-2",on:{click:function(e){return t.goNext(n)}}},[t._v(" "+t._s(t.$t("查看详情"))+" "),a("v-icon",{attrs:{small:"",right:""}},[t._v(" mdi-arrow-right ")])],1)]}},{key:"item.payMethod",fn:function(e){var a=e.item;return[t._v(" "+t._s(t.payMethods.find((function(t){return a.payMethod===t.id})).name)+" ")]}},{key:"item.consumeTypeStatusId",fn:function(e){var a=e.item;return[t._v(" "+t._s(t.statusText(a))+" ")]}},{key:"expanded-item",fn:function(e){var n=e.item;return[a("td",{attrs:{colspan:t.headers.length+1}},[a("v-card",{staticStyle:{width:"100%"}},[a("v-card-title",[t._v(t._s(t.$t("详细信息")))]),a("v-card-text",[a("v-row",[a("v-col",{attrs:{cols:"12",md:"6"}},[a("address-info-block",{attrs:{"address-info":JSON.parse(n.rawAddressInfo)}})],1),a("v-col",{attrs:{cols:"12",md:"6"}},[a("dish-info-block",{attrs:{"dish-orders":n.details}})],1)],1)],1)],1)],1)]}}])})],1)],1)],1)},r=[],s=(a("7db0"),a("c975"),a("b0c0"),a("a9e3"),a("b85c")),i=a("0a61"),o=a("ccdd"),c=a("c1df"),d=a.n(c),l=a("0144"),u=a("633c"),f=a("9225"),h={props:{id:{default:-1,type:Number}},data:function(){return{timer2:null,loading:!0,search:"",headers:[{text:"Id",align:"start",value:"id"},{text:this.$i18n.t("下单时间"),value:"createTimestamp"},{text:this.$i18n.t("totalPrice"),value:"totalPrice"},{text:this.$i18n.t("payMethod"),value:"payMethod"},{text:this.$i18n.t("consumeTypeStatus"),value:"consumeTypeStatusId"},{text:this.$i18n.t("action"),value:"action",sortable:!1}],desserts:[],payMethods:[],consumeTypeStatusList:[]}},beforeDestroy:function(){clearInterval(this.timer2)},created:function(){var t=this;Object(i["n"])().then((function(e){t.payMethods=e.content,t.formatItem()})),Object(i["q"])().then((function(e){t.consumeTypeStatusList=e.content})),this.reloadItem(),this.timer2=setInterval(this.reloadItem,5e3),this.$once("hook:beforeDestroy",(function(){}))},methods:{findLangInArray:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f["a"].locale;return t.find((function(t){return t.lang.toLowerCase()===e.toLowerCase()}))},formatItem:function(){var t,e=Object(s["a"])(this.payMethods);try{for(e.s();!(t=e.n()).done;){var a=t.value;a.name=this.findLangInArray(a.langs).name}}catch(n){e.e(n)}finally{e.f()}},statusText:function(t){return 1===parseInt(t.consumeTypeStatusId)?-1!==["1","2","3"].indexOf(t.payMethod)?"Unbezahlt":"Bezahlt":this.consumeTypeStatusList.find((function(e){return t.consumeTypeStatusId===e.id})).name},acceptOrder:function(t,e){var a=this,n=JSON.parse(t.rawAddressInfo),r=d()();return n&&n.date&&n.time&&(r=d()(n.date+" "+n.time,"DD.MM.YYYY HH:mm")),r.add(e,"m"),l["a"].post("Orders.php?op=acceptTakeawayOrder",{tableId:t.tableId,reason:r.format("DD-MM-YYYY HH:mm")}).then((function(t){console.log(t),a.reloadItem()}))},rejectOrder:function(t){u["hillo"].fastSweetAlertRequest(this.$i18n.t("请输入拒绝接单的理由"),"text","Orders.php?op=rejectTakeAwayOrder","reason",{tableId:t.tableId},this.reloadItem)},reloadItem:function(){var t=this;Object(i["y"])().then((function(e){if(t.desserts=e.content,t.desserts.find((function(t){return t.consumeTypeStatusId<2}))){var a=50,n=function t(){a--,o["a"].play(),a>0&&setTimeout(t,100)};n()}t.loading=!1}))},beforeDestroy:function(){clearTimeout(this.timer2),this.timer2=null},goNext:function(t){this.$router.push({name:"Seite mit den Rechnungsdetails",params:{id:t.id}})}}},m=h,p=a("2877"),v=a("6544"),y=a.n(v),b=a("b0af"),I=a("99d9"),g=a("cc20"),x=a("62ad"),_=a("a523"),w=a("8fea"),T=a("132d"),k=a("0fd9"),S=Object(p["a"])(m,n,r,!1,null,"d5b7b870",null);e["default"]=S.exports;y()(S,{VCard:b["a"],VCardText:I["c"],VCardTitle:I["d"],VChip:g["a"],VCol:x["a"],VContainer:_["a"],VDataTable:w["a"],VIcon:T["a"],VRow:k["a"]})}}]);
//# sourceMappingURL=chunk-2d0da33f.419947fd.js.map