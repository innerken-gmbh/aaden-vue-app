(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-53471ef1"],{8976:function(e,t,a){"use strict";a("d81d"),a("96cf");var n=a("1da1"),i=a("5530"),r=a("633c"),o=a("a86d"),s=a("3405"),l={id:{type:r["a"].Types.Integer,displayName:"id",tableConfig:{align:"start"},formConfig:{requiredNew:!1}},langs:{displayName:"paymentname",type:r["a"].Types.Group,formConfig:{groupName:"paymentname",default:s["a"].supportLang,childLabelKey:"lang",type:{}},tableConfig:{displayCondition:function(e){return e.lang.toUpperCase()===s["a"].lang()}},childKey:"name",children:[o["a"],o["a"],o["a"]]},fixedDisplay:{type:r["a"].Types.Boolean},isOnline:{displayName:"isOnline",type:r["a"].Types.Boolean},apiKey:{required:!1,formConfig:{requiredNew:!1,requiredEdit:!1}}},d={add:function(e){return r["e"].post("PayMethod.php?op=add",Object(i["a"])(Object(i["a"])({},e),{},{langs:JSON.stringify(e.langs)}),{showLoading:!0})},edit:function(e){return r["e"].postWithUploadFile("PayMethod.php?op=update",Object(i["a"])(Object(i["a"])({},e),{},{langs:JSON.stringify(e.langs)}),{showLoading:!0})},remove:function(e){return r["e"].post("PayMethod.php?op=delete",{id:e})},load:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r["e"].get("PayMethod.php",Object(i["a"])({},t));case 2:return e.abrupt("return",e.sent.content.map((function(e){return r["a"].parseDataForEntity(e,l)})));case 3:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()};t["a"]=r["a"].ModelFactory(l,d)},a86d:function(e,t,a){"use strict";var n=a("633c"),i={id:{type:n["a"].Types.Integer,displayName:"id",tableConfig:{align:"start"},formConfig:{requiredNew:!1}},name:{displayName:"Name"},lang:{},desc:{displayName:"Beschreibung",formConfig:{required:!1}}};t["a"]=n["a"].ModelFactory(i,{})},ccb3:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{fluid:""}},[a("v-row",[a("v-col",{attrs:{cols:"8"}},[a("base-material-card",{staticClass:"px-5 py-3 ",attrs:{color:"indigo",icon:"mdi-vuetify",inline:""},scopedSlots:e._u([{key:"after-heading",fn:function(){return[a("div",{staticClass:"display-2 font-weight-light"},[e._v(" "+e._s(e.$t("菜品信息"))+" ")])]},proxy:!0}])},[a("v-divider",{staticClass:"mt-3"}),a("v-data-table",{attrs:{"fixed-header":!0,headers:e.headers,items:e.orders,"items-per-page":15,loading:e.loading,"item-key":"id","multi-sort":""},on:{reloaded:function(t){return e.loadDetail(e.id)}},scopedSlots:e._u([{key:"item.name",fn:function(t){var n=t.item;return[e._v(" "+e._s(n.name)+" "),n.hasMod>0?a("span",{staticClass:"red--text font-weight-bold"},[e._v("*")]):e._e()]}},{key:"item.mod",fn:function(t){var n=t.item;return[a("div",{attrs:{colspan:e.headers.length}},[a("dish-modification",{attrs:{"dish-item":n}})],1)]}}])})],1),"1"===e.billData.billInfo.paymentStatus?a("ik-data-table",{ref:"paymentLog",attrs:{model:e.BillPaymentInfo,icon:"mdi-cards","entity-name":e.$t("付款记录"),"use-action":!1,"use-select":!1,filter:e.filter},scopedSlots:e._u([{key:"footer",fn:function(){return[a("div")]},proxy:!0}],null,!1,3545152822)}):e._e()],1),a("v-col",{attrs:{id:"billPayment",cols:"4"}},[a("base-material-card",{staticClass:"px-5 py-3 ",attrs:{color:"indigo",icon:"mdi-account-cash",inline:""},scopedSlots:e._u([{key:"after-heading",fn:function(){return[a("div",{staticClass:"display-2 font-weight-light"},[e._v(" "+e._s(e.$t("订单信息"))+" ")])]},proxy:!0}])},[a("v-data-table",{attrs:{"fixed-header":!1,headers:e.infoHeaders,items:e.infoList,loading:e.loading,"items-per-page":30,"hide-default-footer":"","hide-default-header":""},scopedSlots:e._u([{key:"item.keyname",fn:function(t){var n=t.item;return[a("span",{staticClass:"font-weight-black"},[e._v(" "+e._s(n.keyname)+" ")])]}},{key:"footer",fn:function(){return[a("v-toolbar",{attrs:{flat:"",dense:"",extended:""},scopedSlots:e._u([{key:"extension",fn:function(){return[a("v-dialog",{attrs:{"max-width":"600"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,i=t.attrs;return[a("v-btn",e._g(e._b({attrs:{color:"red lighten-2",dark:""}},"v-btn",i,!1),n),[e._v(" "+e._s(e.$t("修改支付方式"))+" ")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",[e._v(" "+e._s(e.$t("修改支付方式"))+" TOTAL:"+e._s(e.totalPrice.toFixed(2))+" ")]),a("v-card-text",[a("v-sheet",[a("div",{staticClass:"paymentLogList"},[e._l(e.newPaymentLog,(function(t,n){return[a("div",{key:"log"+n,staticClass:"d-flex"},[e._v(" "+e._s(t.name)+":"+e._s(t.price.toFixed(2))+" ")])]}))],2),a("div",{staticClass:"d-flex justify-space-between align-center"},[a("v-text-field",{attrs:{label:"Amount",type:"number",min:"0",step:"0.01"},model:{value:e.newAmount,callback:function(t){e.newAmount=t},expression:"newAmount"}}),a("v-select",{staticClass:"ml-4",attrs:{label:"Art des Payment","item-value":"id","item-text":"name",items:e.payMethods},model:{value:e.newId,callback:function(t){e.newId=t},expression:"newId"}}),a("v-btn",{staticClass:"ml-2",attrs:{disabled:!e.newAmount||!e.newId,color:"primary"},on:{click:e.insertNewPaymentLog}},[a("v-icon",{attrs:{left:""}},[e._v(" mdi-plus ")]),e._v(" "+e._s(e.$t("OK"))+" ")],1)],1)])],1),a("v-divider"),a("v-card-actions",[a("v-btn",{attrs:{color:"primary",text:""},on:{click:function(t){e.newPaymentLog=[]}}},[e._v(" "+e._s(e.$t("Cancel"))+" ")]),a("v-spacer"),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.updatePaymentLog}},[e._v(" "+e._s(e.$t("完成"))+" ")])],1)],1)],1)]},proxy:!0}])},[a("v-btn",{attrs:{dark:""}},[a("v-icon",{attrs:{left:""}},[e._v(" mdi-arrow-left ")]),e._v(" "+e._s(e.$t("返回"))+" ")],1),a("v-spacer"),a("v-btn",{directives:[{name:"print",rawName:"v-print",value:"#detail",expression:"'#detail'"}],attrs:{color:"green darken-1",dark:""},on:{click:e.reprintOrder}},[e._v(" "+e._s(e.$t("补打订单"))+" ")])],1)]},proxy:!0}])})],1)],1),a("v-col",{staticClass:"printText",attrs:{cols:"12",md:"6"}},[e.rawAddressInfo?a("base-material-card",{staticClass:"px-5 py-3 ",attrs:{color:"indigo",icon:"mdi-account-cash",inline:""},scopedSlots:e._u([{key:"after-heading",fn:function(){return[a("div",{staticClass:"display-2 font-weight-light"},[e._v(" "+e._s(e.$t("地址信息"))+" ")])]},proxy:!0}],null,!1,2582449564)},[a("v-row",[a("v-col",{attrs:{cols:"12",md:"12"}},[a("address-info-block",{attrs:{"address-info":e.rawAddressInfo}})],1)],1)],1):e._e()],1),e.rawAddressInfo?a("v-col",{staticClass:"printText",attrs:{cols:"12",md:"6"}},[a("base-material-card",{staticClass:"px-5 py-3 ",attrs:{color:"indigo",icon:"mdi-printer",inline:""},scopedSlots:e._u([{key:"after-heading",fn:function(){return[a("div",{staticClass:"display-2 font-weight-light"},[e._v(" "+e._s(e.$t("打印订单"))+" ")])]},proxy:!0}],null,!1,1893731830)},[a("v-row",[a("v-col",{staticClass:"d-flex spaceBetween",staticStyle:{width:"100%"},attrs:{cols:"12",md:"12"}},[a("div",{staticClass:"mr-2"},[a("v-alert",{attrs:{border:"left","colored-border":"",color:"deep-purple accent-4",elevation:"2"}},[e._v(" "+e._s(e.$t("此处打印的订单仅供参考,不可作为Rechnung使用"))+" ")])],1),a("v-btn",{attrs:{right:"",large:"",color:"success",dark:""},on:{click:function(t){t.stopPropagation(),e.printDialogShow=!0}}},[e._v(" "+e._s(e.$t("打印"))+" ")])],1)],1)],1)],1):e._e(),a("v-dialog",{attrs:{"max-width":"400px"},model:{value:e.printDialogShow,callback:function(t){e.printDialogShow=t},expression:"printDialogShow"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[e._v(" "+e._s(e.$t("打印此订单?"))+" ")]),a("v-card-text",{attrs:{id:"detail"}},[a("v-card-subtitle",[e._v(e._s(e.$t("地址信息")))]),a("v-divider"),a("address-info-block",{attrs:{"address-info":e.rawAddressInfo}}),a("v-card-subtitle",[e._v(e._s(e.$t("订单信息")))]),a("v-divider"),a("dish-info-block",{attrs:{"render-list":!0,"dish-orders":e.orders}})],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:function(t){e.printDialogShow=!1}}},[e._v(" "+e._s(e.$t("Cancel"))+" ")]),a("v-btn",{directives:[{name:"print",rawName:"v-print",value:"#detail",expression:"'#detail'"}],attrs:{color:"green darken-1",text:""},on:{click:function(t){e.printDialogShow=!1}}},[e._v(" "+e._s(e.$t("打印"))+" ")])],1)],1)],1)],1)],1)},i=[],r=(a("4de4"),a("7db0"),a("d81d"),a("13d5"),a("b0c0"),a("a9e3"),a("ac1f"),a("1276"),a("96cf"),a("1da1")),o=a("5530"),s=a("0a61"),l=a("9225"),d=a("f683"),c=a("4907"),u=a("d926"),p=(a("99af"),a("2909")),m=a("3405"),f=a("633c"),v=a("8976"),y={id:{type:f["a"].Types.Integer,displayName:"ID",tableConfig:{align:"start"},form:!1},paymentMethodId:{type:f["a"].Types.Option,formConfig:{type:{selectItems:v["a"].getList,itemText:"_langsname"}},displayName:"payMethod"},createdAt:{form:!1},memberCardId:{form:!1},amount:{form:!1}},g={load:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,f["e"].get("BackendData.php",Object.assign.apply(Object,[{op:"billDetail",lang:m["a"].lang()}].concat(Object(p["a"])(t))));case 2:return e.abrupt("return",e.sent.billPaymentInfo.map((function(e){return f["a"].parseDataForEntity(e,y)})));case 3:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}(),edit:function(e){return f["e"].post("Orders.php?op=updatePaymentMethod",e,{showLoading:!0})}},h=f["a"].ModelFactory(y,g),b=a("3d20"),w=a.n(b),x=a("d75f"),k={components:{DishModification:u["default"],DishInfoBlock:c["default"],AddressInfoBlock:d["default"],IkDataTable:f["c"]},props:{id:{default:"-1",type:[String,Number]}},data:function(){return{newId:null,newAmount:null,BillPaymentInfo:h,loading:!1,orderId:this.id,billData:{billInfo:{paymentStatus:0}},printDialogShow:!1,newPaymentLog:[],dialog:null,payMethods:[],rawAddressInfo:"",infoHeaders:[{value:"keyname",align:"left"},{value:"value",align:"right"}],infoList:[],headers:[{text:this.$i18n.t("code"),align:"start",sortable:!1,value:"code"},{text:this.$i18n.t("name"),value:"name"},{text:this.$i18n.t("modification"),value:"mod"},{text:this.$i18n.t("createTimestamp"),value:"stamp"},{text:this.$i18n.t("price"),value:"price"},{text:this.$i18n.t("count"),value:"sumCount"},{text:this.$i18n.t("sumPrice"),value:"totalPrice"},{text:this.$i18n.t("note"),value:"note"}],orders:[],defaultItem:{paymentMethodId:-1,name:""},consumeTypeStatusList:[],consumeTypeStatus:"",paymentStatus:""}},computed:{filter:function(){return{id:this.id}},totalPrice:function(){var e,t=null!==(e=this.billData.billInfo.totalPrice)&&void 0!==e?e:0;return t-this.newPaymentLog.reduce((function(e,t){return parseFloat(e)+parseFloat(t.price)}),0)}},mounted:function(){this.reloadItem(this.orderId)},methods:{insertNewPaymentLog:function(){var e,t,a=this;this.newPaymentLog.push(f["b"].deepCopy({id:this.newId,name:null!==(e=null===(t=this.payMethods.find((function(e){return e.id===a.newId})))||void 0===t?void 0:t.name)&&void 0!==e?e:"",price:parseFloat(this.newAmount)})),this.newId=null,this.newAmount=null},loadDetail:function(e){var t=this;Object(s["k"])(e).then((function(e){t.billData=e,t.orders=t.billData.billOrderInfo.map((function(e,t){return Object(o["a"])({id:t,agNameArr:e.hasMod>0?e.agName.split(","):[],aNameArr:e.hasMod>0?e.aName.split(","):[]},e)})),t.rawAddressInfo=JSON.parse(t.billData.billInfo.rawAddressInfo),t.paymentStatus="1"===t.billData.billInfo.paymentStatus?t.$i18n.t("已支付"):t.$i18n.t("未支付"),t.consumeTypeStatus=t.consumeTypeStatusList.find((function(e){return parseInt(t.billData.billInfo.consumeTypeStatusId)===e.id})).name,t.infoList=[{keyname:t.$i18n.t("订单号"),value:t.billData.billInfo.id},{keyname:t.$i18n.t("servantName"),value:t.billData.billInfo.servantName},{keyname:t.$i18n.t("tableName"),value:t.billData.billInfo.tableName},{keyname:t.$i18n.t("startTime"),value:t.billData.billInfo.startTime},{keyname:t.$i18n.t("结账时间"),value:t.billData.billInfo.endTime},{keyname:t.$i18n.t("payMethod"),value:t.billData.billInfo.payMethodName},{keyname:t.$i18n.t("支付状态"),value:t.paymentStatus},{keyname:t.$i18n.t("consumeTypeStatus"),value:t.consumeTypeStatus},{keyname:t.$i18n.t("personCount"),value:t.billData.billInfo.personCount},{keyname:t.$i18n.t("tipIncome"),value:t.billData.billInfo.tipIncome},{keyname:t.$i18n.t("discount"),value:t.billData.billInfo.discountStr},{keyname:t.$i18n.t("totalPrice"),value:t.billData.billInfo.totalPrice}]}))},reloadItem:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.dialog=!1,t.$nextTick((function(){t.$refs.paymentLog.reload()})),a.next=4,x["a"].getList();case 4:return t.consumeTypeStatusList=a.sent,a.next=7,v["a"].getList();case 7:t.payMethods=a.sent.filter((function(e){return 0!==e.id&&9!==e.id})),t.loadDetail(e);case 9:case"end":return a.stop()}}),a)})))()},reprintOrder:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var a,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,w.a.fire({title:e.$i18n.t("Bitte wählen Sie eine Rechnungsart."),input:"select",inputOptions:{1:e.$i18n.t("Normal Rechnung"),2:e.$i18n.t("Unternehmensrechnung-1"),3:e.$i18n.t("Unternehmensrechnung-2")}});case 2:a=t.sent,a.value&&(a.value=parseInt(a.value),n=0,i=1,a.value>1&&(n=1),a.value>2&&(i=2),Object(s["t"])(e.id,n,i));case 4:case"end":return t.stop()}}),t)})))()},findLangInArray:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l["a"].locale;return e.find((function(e){return e.lang.toLowerCase()===t.toLowerCase()}))},goBack:function(){this.$router.history.go(-1)},updatePaymentLog:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(s["x"])(e.orderId,e.newPaymentLog);case 2:e.reloadItem(e.orderId);case 3:case"end":return t.stop()}}),t)})))()}}},_=k,I=a("2877"),C=a("6544"),$=a.n(C),S=a("0798"),D=a("8336"),N=a("b0af"),T=a("99d9"),L=a("62ad"),O=a("a523"),P=a("8fea"),A=a("169a"),M=a("ce7e"),j=a("132d"),V=a("0fd9"),R=a("b974"),F=a("8dd9"),B=a("2fa4"),q=a("8654"),K=a("71d9"),J=Object(I["a"])(_,n,i,!1,null,"62fe07f1",null);t["default"]=J.exports;$()(J,{VAlert:S["a"],VBtn:D["a"],VCard:N["a"],VCardActions:T["a"],VCardSubtitle:T["b"],VCardText:T["c"],VCardTitle:T["d"],VCol:L["a"],VContainer:O["a"],VDataTable:P["a"],VDialog:A["a"],VDivider:M["a"],VIcon:j["a"],VRow:V["a"],VSelect:R["a"],VSheet:F["a"],VSpacer:B["a"],VTextField:q["a"],VToolbar:K["a"]})},d75f:function(e,t,a){"use strict";var n=a("5530"),i=(a("96cf"),a("1da1")),r=a("633c"),o=a("3405"),s=a("a86d"),l={id:{type:r["a"].Types.Integer,displayName:"id",tableConfig:{align:"start"},formConfig:{requiredNew:!1}},langs:{displayName:"consumeTypeStatusName",type:r["a"].Types.Group,formConfig:{groupName:"consumeTypeStatusName",default:o["a"].supportLang,childLabelKey:"lang",type:{}},tableConfig:{displayCondition:function(e){return e.lang.toUpperCase()===o["a"].lang()}},childKey:"name",labelKey:"lang",children:[s["a"],s["a"],s["a"]]},name:{displayName:"consumeTypeStatus"}},d={load:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r["e"].get("Orders.php",Object(n["a"])({op:"showConsumeTypeStatusList"},t));case 2:return e.abrupt("return",e.sent.content);case 3:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()};t["a"]=r["a"].ModelFactory(l,d)}}]);
//# sourceMappingURL=chunk-53471ef1.f100d692.js.map