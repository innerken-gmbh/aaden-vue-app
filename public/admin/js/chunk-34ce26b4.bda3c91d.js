(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-34ce26b4"],{"0421":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n("633c");function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t,n,r,a,i,o){try{var u=e[i](o),l=u.value}catch(c){return void n(c)}u.done?t(l):Promise.resolve(l).then(r,a)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){u(i,r,a,o,l,"next",e)}function l(e){u(i,r,a,o,l,"throw",e)}o(void 0)}))}}var c={id:{type:r.IKDataEntity.Types.Integer,displayName:"id",tableConfig:{align:"start"},formConfig:{requiredNew:!1}},name:{displayName:"allergName"},icon:{displayName:"icon"},shortName:{displayName:"shortName"},displayText:{displayName:"displayText"}},s={add:function(e){return r.hillo.postWithUploadFile("Dishes.php?op=addAllergen",e,{showLoading:!0})},edit:function(e){return r.hillo.postWithUploadFile("Dishes.php?op=updateAllergen",e,{showLoading:!0})},remove:function(e){return r.hillo.post("Dishes.php?op=deleteAllergen",{id:e})},load:function(){var e=l((function*(e){return(yield r.hillo.get("Dishes.php",i({op:"showAllAllergen"},e))).content}));function t(t){return e.apply(this,arguments)}return t}()},p=r.IKDataEntity.ModelFactory(c,s);t.default=p},"07bf":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.openTable=s,t.getCurrentStatus=p,t.rearrangeDish=f,t.addDishesToTable=y,t.getOrderInfo=h,t.requireCheckOut=v,t.submitBill=b,t.callServant=O,t.fetchConfig=w,t.resolveBestIP=P,t.getActiveTables=T,t.getTableList=N,t.getOneBusyTable=x,t.findConsumeTypeById=L;var r=n("633c"),a=o(n("4eed")),i=o(n("ee60"));function o(e){return e&&e.__esModule?e:{default:e}}function u(e,t,n,r,a,i,o){try{var u=e[i](o),l=u.value}catch(c){return void n(c)}u.done?t(l):Promise.resolve(l).then(r,a)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){u(i,r,a,o,l,"next",e)}function l(e){u(i,r,a,o,l,"throw",e)}o(void 0)}))}}var c={noDebug:!0};function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;return r.hillo.post("Complex.php?op=openTableWithScanQR",{tableId:e,consumeTypeId:t})}function p(e){return r.hillo.silentGet("Tables.php",{name:e})}var d=[9,10,11,"9","10","11"];function f(e,t,n){return console.log(n),e=e.map(e=>(e.dishes=t.filter(t=>t.categoryId===e.id).map(e=>(e.count=0,e.note="",e)),e)),n.map(t=>(t.categories=e.filter(e=>parseInt(t.id)===parseInt(e.dishesCategoryTypeId)),t)).filter(e=>d.includes(e.id)).sort((e,t)=>9===parseInt(t.id)?-1:9===parseInt(e.id)?1:parseInt(e.id)<parseInt(t.id)?-1:parseInt(e.id)>parseInt(t.id)?1:0)}function y(e,t){return r.hillo.post("Complex.php?op=addDishesToTable",{tableId:e,params:JSON.stringify(t)})}function h(e){return g.apply(this,arguments)}function g(){return g=l((function*(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(yield r.hillo.get("Complex.php",{op:"dishesInTable",tableId:e,lang:a.default.lang(),usePrintModAsName:0|t},c)).content})),g.apply(this,arguments)}function v(e,t){return m.apply(this,arguments)}function m(){return m=l((function*(e,t){return(yield r.hillo.post("Complex.php?op=requireCheckOut",{op:"requireCheckOut",tableId:e,payMethod:t,lang:a.default.lang()})).content})),m.apply(this,arguments)}function b(e,t){return I.apply(this,arguments)}function I(){return I=l((function*(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return(yield r.hillo.post("Complex.php?op=checkOut",{op:"checkOut",tableId:e,payMethod:t,tipIncome:n,personCount:a})).content})),I.apply(this,arguments)}function O(e){return r.hillo.get("Complex.php",{op:"callServant",lang:a.default.lang(),tableId:e})}function w(){return D.apply(this,arguments)}function D(){return D=l((function*(){try{var e=yield fetch("/"+(a.default.Dir?a.default.Dir+"/":"")+"Resource/config/config.json");return yield e.json()}catch(t){return console.warn("no Config found"),{}}})),D.apply(this,arguments)}function P(e){return j.apply(this,arguments)}function j(){return j=l((function*(e){var t=yield r.hillo.get("https://innerken.com/iplogger/",{op:"findBestIp",deviceId:null!==e&&void 0!==e?e:a.default.DeviceId});return t.content})),j.apply(this,arguments)}var C=null;function T(){return A.apply(this,arguments)}function A(){return A=l((function*(){var e=yield r.hillo.get("Tables.php",{op:"showAllTableWithSection"},c);return C=S(e.content),C})),A.apply(this,arguments)}function N(){return E.apply(this,arguments)}function E(){return E=l((function*(){return null==C||0===C.length?yield T():C})),E.apply(this,arguments)}function x(){return K.apply(this,arguments)}function K(){return K=l((function*(){var e=(yield N()).reduce((e,t)=>e.concat(t.tables),[]).find(e=>0!==parseInt(e.usageStatus));return e})),K.apply(this,arguments)}function S(e){for(var t in C=[],e){var n={};for(var r of(n.areaName=t,n.tables=e[t],n.tables))r.consumeType?r.consumeTypeName=L(r.consumeType).name:r.consumeTypeName="AVL";C.push(n)}return C}var k=[];function L(e){return _.apply(this,arguments)}function _(){return _=l((function*(e){for(var t of(0===k.length&&(k=yield i.default.getList()),k))if(parseInt(t.id)===parseInt(e))return t;return null})),_.apply(this,arguments)}},"194c":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n("4eed")),a=n("633c");function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t,n,r,a,i,o){try{var u=e[i](o),l=u.value}catch(c){return void n(c)}u.done?t(l):Promise.resolve(l).then(r,a)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){c(i,r,a,o,u,"next",e)}function u(e){c(i,r,a,o,u,"throw",e)}o(void 0)}))}}var p={id:{type:a.IKDataEntity.Types.Integer,displayName:"id",tableConfig:{align:"start"},formConfig:{requiredNew:!1}},name:{},lang:{}},d={load:function(){var e=s((function*(e){return(yield a.hillo.get("CategoryType.php",u({lang:r.default.lang()},e))).content}));function t(t){return e.apply(this,arguments)}return t}()},f=a.IKDataEntity.ModelFactory(p,d);t.default=f},"2e88":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n("633c"),a=l(n("194c")),i=l(n("85e4")),o=l(n("c5e4")),u=l(n("4eed"));function l(e){return e&&e.__esModule?e:{default:e}}function c(e,t,n,r,a,i,o){try{var u=e[i](o),l=u.value}catch(c){return void n(c)}u.done?t(l):Promise.resolve(l).then(r,a)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){c(i,r,a,o,u,"next",e)}function u(e){c(i,r,a,o,u,"throw",e)}o(void 0)}))}}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var y={id:{type:r.IKDataEntity.Types.Integer,displayName:"id",tableConfig:{align:"start"},formConfig:{requiredNew:!1}},langs:{displayName:"labelName",type:r.IKDataEntity.Types.Group,formConfig:{groupName:"labelName",default:u.default.supportLang,childLabelKey:"lang",type:{}},tableConfig:{displayCondition:e=>e.lang.toUpperCase()===u.default.lang(),displayChild:e=>"name"===e},childKey:["name","desc"],labelKey:"lang",children:[o.default,o.default,o.default]},dishesCategoryTypeId:{displayName:"labelType",type:r.IKDataEntity.Types.Option,formConfig:{type:{selectItems:a.default.getList}}},attributeGroupId:{displayName:"attributeGroupNames",type:r.IKDataEntity.Types.Option,formConfig:{required:!1,type:{selectItems:i.default.getList,multiple:!0}}}},h={add:function(e){return e.appliedAttributeGroup=e.attributeGroupId.join(","),e.catTypeId=e.dishesCategoryTypeId,r.hillo.post("Category.php?op=add",d(d({},e),{},{langs:JSON.stringify(e.langs)}),{showLoading:!0})},edit:function(e){return e.appliedAttributeGroup=e.attributeGroupId.join(","),e.catTypeId=e.dishesCategoryTypeId,r.hillo.postWithUploadFile("Category.php?op=update",d(d({},e),{},{langs:JSON.stringify(e.langs)}),{showLoading:!0})},remove:function(e){return r.hillo.post("Category.php?op=delete",{id:e})},load:function(){var e=s((function*(e){return(yield r.hillo.get("Category.php",d({},e))).content.map((function(e){return r.IKDataEntity.parseDataForEntity(e,y)}))}));function t(t){return e.apply(this,arguments)}return t}()},g=r.IKDataEntity.ModelFactory(y,h);t.default=g},"2f69":function(e,t,n){"use strict";var r=n("5530"),a=(n("96cf"),n("1da1")),i=n("3405"),o=n("633c"),u=n("b0d9"),l=n("ebc9"),c={id:{type:o["IKDataEntity"].Types.Integer,displayName:"id",tableConfig:{align:"start"},form:!1},name:{displayName:"name"},attributeGroupId:{displayName:"groupName",type:o["IKDataEntity"].Types.Option,formConfig:{type:{selectItems:u["a"].forceGetList}}},isMultiChosen:{type:o["IKDataEntity"].Types.Boolean},value:{displayName:"value"},printMod:{displayName:"printMod"},priceMod:{type:o["IKDataEntity"].Types.Float,displayName:"priceMod",formConfig:{overwriteRule:!0,rule:[function(e){return/^[0-9]+\.{0,1}[0-9]{0,2}$/.test(e)||"please enter the correct price"}]}},dishesCategoryTypeId:{displayName:"labelType",type:o["IKDataEntity"].Types.Option,formConfig:{type:{selectItems:l["a"].getList}}}},s={add:function(e){return o["hillo"].postWithUploadFile("Category.php?op=addAttribute",e,{showLoading:!0})},edit:function(e){return o["hillo"].postWithUploadFile("Category.php?op=updateAttribute",e,{showLoading:!0})},remove:function(e){return o["hillo"].post("Category.php?op=deleteAttribute",{id:e})},load:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,o["hillo"].get("Category.php",Object(r["a"])({op:"showAttribute",lang:i["a"].lang()},t));case 2:return e.abrupt("return",e.sent.content);case 3:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()};t["a"]=o["IKDataEntity"].ModelFactory(c,s)},"30c8":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n("633c"),a=c(n("4eed")),i=c(n("2e88")),o=c(n("0421")),u=c(n("c5e4")),l=c(n("85e4"));function c(e){return e&&e.__esModule?e:{default:e}}function s(e,t,n,r,a,i,o){try{var u=e[i](o),l=u.value}catch(c){return void n(c)}u.done?t(l):Promise.resolve(l).then(r,a)}function p(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){s(i,r,a,o,u,"next",e)}function u(e){s(i,r,a,o,u,"throw",e)}o(void 0)}))}}function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h={id:{type:r.IKDataEntity.Types.Integer,displayName:"id",tableConfig:{align:"start"},formConfig:{requiredNew:!1}},code:{formConfig:{required:!1}},image:{type:r.IKDataEntity.Types.Image,formConfig:{type:{root:()=>a.default.rootUrl()+a.default.dishImageRoot},required:!1},displayName:"image"},langs:{displayName:"name",type:r.IKDataEntity.Types.Group,formConfig:{groupName:"name",default:a.default.supportLang,childLabelKey:"lang",type:{}},tableConfig:{displayCondition:e=>e.lang.toUpperCase()===a.default.lang(),displayChild:e=>"name"===e},childKey:["name","desc"],children:[u.default,u.default,u.default]},price:{type:r.IKDataEntity.Types.Float,formConfig:{default:"",required:!1,rule:[e=>/^[0-9]+\.{0,1}[0-9]{0,2}$/.test(e)||"please enter the correct price"]}},categoryId:{displayName:"dishCatName",type:r.IKDataEntity.Types.Option,formConfig:{type:{selectItems:i.default.getList,itemText:"_langsname"}}},AllergenId:{type:r.IKDataEntity.Types.Option,formConfig:{type:{selectItems:o.default.getList,multiple:!0},required:!1},displayName:"过敏源"},attributeGroupId:{displayName:"attributeGroupNames",type:r.IKDataEntity.Types.Option,formConfig:{merge:!1,type:{selectItems:l.default.getList,multiple:!0,disabledItem:(e,t)=>t.inheritAttributeGroupId?f(f({},e),{},{disabled:t.inheritAttributeGroupId.includes(e.id)}):e}}},localAttributeGroupId:{type:r.IKDataEntity.Types.Option,formConfig:{type:{selectItems:l.default.getList,multiple:!0},inNew:!1,inEdit:!1},header:!1},inheritAttributeGroupId:{displayName:"AttributeGroupName",type:r.IKDataEntity.Types.Option,formConfig:{type:{selectItems:l.default.getList,multiple:!0},inNew:!1,inEdit:!1},header:!1},isActive:{type:r.IKDataEntity.Types.Boolean,displayName:"isActive",formConfig:{default:1}}},g={add:function(e){return e.attributeGroup=e.attributeGroupId.filter(t=>!e.inheritAttributeGroupId.includes(t)).join(","),e.allergenGroup=e.AllergenId.join(","),r.hillo.postWithUploadFile("Dishes.php?op=add",f(f({},e),{},{params:JSON.stringify(e)}),{showLoading:!0})},edit:function(e){return e.attributeGroup=e.attributeGroupId.filter(t=>!e.inheritAttributeGroupId.includes(t)).join(","),e.allergenGroup=e.AllergenId.join(","),e.file&&(e.imageExt=e.file.name.split(".")[1]),r.hillo.postWithUploadFile("Dishes.php?op=update",f(f({},e),{},{params:JSON.stringify(e)}),{showLoading:!0})},remove:function(e){return r.hillo.post("Dishes.php?op=delete",{id:e})},load:function(){var e=p((function*(e){return(yield r.hillo.get("Dishes.php",f({},e))).content.map((function(e){return e.id=e.dishId,e.attributeGroupId=[e.inheritAttributeGroupId?e.inheritAttributeGroupId.split(","):[],e.localAttributeGroupId?e.localAttributeGroupId.split(","):[]].flat().join(","),e.langs=e.langs.map(e=>f(f({},e),{},{desc:e.description})),e}))}));function t(t){return e.apply(this,arguments)}return t}()},v=r.IKDataEntity.ModelFactory(h,g);v.getBuffet=p((function*(){return(yield v.getList()).filter(e=>"8"===e.dishesCategoryTypeId)}));var m=v;t.default=m},"32f5":function(e,t,n){"use strict";var r=n("4649"),a=n.n(r);a.a},4649:function(e,t,n){},"4eed":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initSettings=l,t.initialAadenBase=s,t.default=void 0;var r=n("07bf"),a=n("633c");function i(e,t,n,r,a,i,o){try{var u=e[i](o),l=u.value}catch(c){return void n(c)}u.done?t(l):Promise.resolve(l).then(r,a)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function u(e){i(o,r,a,u,l,"next",e)}function l(e){i(o,r,a,u,l,"throw",e)}u(void 0)}))}}var u={name:"GlobalSetting",DeviceId:-1,Base:"localhost",initialed:!1,SQR:"https://qr.topscan.com/api.php?text=",genSQUrl:"web/ScanToOrder/Orders/ConfirmPage/?",endPoint:"PHP/",Dir:"",Protocol:"http://",Port:"",dishImageRoot:"Resource/dishImg/",servantRoot:"Resource/servantImg/",DefaultLocale:"de",supportLang:[{lang:"zh",id:"1",name:""},{lang:"en",id:"2",name:""},{lang:"de",id:"3",name:""}],ServantImgRoot:"Resource/servantImg/",companyRoot:"https://innerken.com/iplogger/"};function l(e){return c.apply(this,arguments)}function c(){return c=o((function*(e){Object.assign(u,e),u.Base&&"localhost"!==u.Base||-1!==u.DeviceId&&(u.Base=yield(0,r.resolveBestIP)()),u.lang||(u.lang=function(){return u.DefaultLocale.toUpperCase()}),u.getBase=function(){return u.Protocol+u.Base+"/"},u.getEndPoint=function(){return u.getBase()+u.endPoint}})),c.apply(this,arguments)}function s(e){return p.apply(this,arguments)}function p(){return p=o((function*(e){return yield l(e),a.ego.initial(u.getEndPoint()),u})),p.apply(this,arguments)}var d=u;t.default=d},"591e":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StandardDishesListFactory=g,t.getDishesInfo=D,t.getDishes=j;var r=u(n("30c8")),a=u(n("194c")),i=n("633c"),o=u(n("2e88"));function u(e){return e&&e.__esModule?e:{default:e}}function l(e,t,n,r,a,i,o){try{var u=e[i](o),l=u.value}catch(c){return void n(c)}u.done?t(l):Promise.resolve(l).then(r,a)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){l(i,r,a,o,u,"next",e)}function u(e){l(i,r,a,o,u,"throw",e)}o(void 0)}))}}var s={note:"",apply:[],modShow:!1,forceFormat:!1};function p(e){var t,n,r=[];return e.apply||e.agName?((null===e||void 0===e||null===(t=e.apply)||void 0===t?void 0:t.length)>0?e.apply.forEach(t=>{var n=e.modInfo.find(e=>e.id===t.groupId),a=n.name,i=[t.selectId].flat().reduce((e,t)=>{if(!t)return e;var r=n.selectValue.indexOf(t),i="".concat(n.selectName[r]),o=n.priceInfo[r];return e.push({groupName:a,value:i,priceInfo:o,hash:a+":"+i+"p"+o}),e},[]);r=r.concat(i)}):(null===e||void 0===e||null===(n=e.agName)||void 0===n?void 0:n.length)>0&&([e.agNameArr,e.aNameArr,e.priceInfoArr,e.agIdArr,e.aIdArr]=[e.agName,e.aName,e.priceInfo,e.agId,e.aId].map(e=>e.split(",")),e.agNameArr.forEach((t,n)=>{r.push({agId:e.agIdArr[n],aId:e.aIdArr[n],groupName:t,value:e.aNameArr[n],priceInfo:e.priceInfoArr[n],hash:t+":"+e.aNameArr[n]+"p"+e.priceInfoArr[n]+"g"+e.agIdArr[n]})})),r):r}function d(e){var t=0;return e.displayApply.forEach(e=>{var n;t+=parseFloat(null!==(n=e.priceInfo)&&void 0!==n?n:0)}),t}function f(e){return e.reduce((e,t)=>(e.push(t.hash),e),[]).join("/")}function y(e,t,n,r,a){return e+"&"+f(t)+"-&-"+n+"-&-"+r+"-&-"+a}function h(e){var t,n,r,a,i;e.note=null!==(t=e.note)&&void 0!==t?t:"",e.displayApply=p(e),e.addPrice=d(e),e.originPrice=parseFloat(0===parseFloat(e.price)?0:null!==(n=null!==(r=e.originPrice)&&void 0!==r?r:e.price)&&void 0!==n?n:0),e.realPrice=parseFloat(e.originPrice)+parseFloat(e.addPrice)+parseFloat(null!==(a=e.tempDiscountMod)&&void 0!==a?a:0),e.code.includes("ea")&&(e.realPrice=e.price),e.identity=y(e.code,e.displayApply,e.note,e.tempDiscountStr,null!==(i=e.price)&&void 0!==i?i:e.realPrice)}function g(){var e=[],t={},n={},r=0,a=function(t,a){var o=i.IKUtils.deepCopy(t);o.count=null!==a&&void 0!==a?a:t.count,o.sumCount=o.count,o.hash=r,h(o),r++,n[o.identity]=o,o.change=function(e){p(o,e)},e.push(o)};function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];(null===e||void 0===e?void 0:e.length)>0&&Object.assign(t,e.reduce((e,t)=>(e[t.code]=t,e),{}))}function u(e){return l(e,!1)}function l(e){var t,n,r,a,o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],u=o?i.IKUtils.deepCopy(e):e;return u.count=parseInt(null!==(t=null!==(n=u.count)&&void 0!==n?n:u.sumCount)&&void 0!==t?t:0),u.name=null!==(r=null!==(a=u.name)&&void 0!==a?a:u.dishName)&&void 0!==r?r:u._langsname,h(u),u.wellFormat=!0,Object.assign({},s,u)}function c(){return Object.keys(t).reduce((e,n)=>(e.push(t[n]),e),[])}var p=function(r,i){var o=t[r.code];o&&(parseInt(o.count)+parseInt(i)>0?o.count+=i:o.count=0),r.wellFormat&&!r.forceFormat||(r.forceFormat=!1,r=l(r));var u=n[r.identity];u?u.count+i>0?(u.count+=i,u.sumCount=u.count):(e.splice(e.indexOf(u),1),delete n[r.identity]):(i>=0||r.count>=0)&&a(r,i)},d=function(e){return e.map(u)},f=function(e,t){p(e,t)},y=function(e,t){p(e,t)},g=function(){return e.reduce((e,t)=>e+parseFloat(t.realPrice*t.count),0)},v=function(){return parseInt(e.reduce((e,t)=>e+parseInt(t.count),0))},m=function(e){b(e)},b=function(e){for(var t of(I(),e))f(t)},I=function(){for(var r of Object.keys(t))t[r].count=0;for(var a of Object.keys(n))delete n[a];e.splice(0,e.length)};return{orderDictionary:n,setDishList:o,dishDictionary:t,list:e,getDishList:c,add:f,remove:y,total:g,count:v,loadTTDishList:m,formatList:d,loadList:b,clear:I}}var v=[],m=[],b=[],I=[];function O(e,t,n){return e=e.map(e=>(e.dishes=t.filter(t=>t.categoryId===e.id).map(e=>(e.count=0,e.note="",e)),e)).filter(e=>e.dishes.length>0),n.map(t=>(t.categories=e.filter(e=>parseInt(t.id)===parseInt(e.dishesCategoryTypeId)),t)).sort((e,t)=>9===parseInt(t.id)?-1:9===parseInt(e.id)?1:parseInt(e.id)<parseInt(t.id)?-1:parseInt(e.id)>parseInt(t.id)?1:0)}var w=g();function D(){return P.apply(this,arguments)}function P(){return P=c((function*(){return 0===I.length&&([b,m,v]=yield Promise.all([j(),o.default.getList(),a.default.getList()]),I=O(m,b,v)),I})),P.apply(this,arguments)}function j(){return C.apply(this,arguments)}function C(){return C=c((function*(){return 0===b.length&&(b=w.formatList(yield r.default.getList())),b})),C.apply(this,arguments)}},"85e4":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n("4eed")),a=n("633c");function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t,n,r,a,i,o){try{var u=e[i](o),l=u.value}catch(c){return void n(c)}u.done?t(l):Promise.resolve(l).then(r,a)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){c(i,r,a,o,u,"next",e)}function u(e){c(i,r,a,o,u,"throw",e)}o(void 0)}))}}var p={id:{type:a.IKDataEntity.Types.Integer,displayName:"id",tableConfig:{align:"start"},formConfig:{requiredNew:!1}},name:{},required:{type:a.IKDataEntity.Types.Boolean},multiSelect:{type:a.IKDataEntity.Types.Boolean},printTitle:{}},d={load:function(){var e=s((function*(e){return(yield a.hillo.get("Category.php",u({op:"showAttributeGroup",lang:r.default.lang()},e))).content}));function t(t){return e.apply(this,arguments)}return t}(),add:function(e){return a.hillo.postWithUploadFile("Category.php?op=addAttributeGroup",e,{showLoading:!0})},edit:function(e){return a.hillo.postWithUploadFile("Category.php?op=updateAttributeGroup",e,{showLoading:!0})},remove:function(e){return a.hillo.post("Category.php?op=deleteAttributeGroup",{id:e})}},f=a.IKDataEntity.ModelFactory(p,d);t.default=f},b0d9:function(e,t,n){"use strict";var r=n("5530"),a=(n("96cf"),n("1da1")),i=n("3405"),o=n("633c"),u={id:{type:o["IKDataEntity"].Types.Integer,displayName:"id",tableConfig:{align:"start"},form:!1},name:{},printTitle:{},required:{type:o["IKDataEntity"].Types.Boolean},multiSelect:{type:o["IKDataEntity"].Types.Boolean}},l={load:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,o["hillo"].get("Category.php",Object(r["a"])({op:"showAttributeGroup",lang:i["a"].lang()},t));case 2:return e.abrupt("return",e.sent.content);case 3:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}(),add:function(e){return o["hillo"].postWithUploadFile("Category.php?op=addAttributeGroup",e,{showLoading:!0})},edit:function(e){return o["hillo"].postWithUploadFile("Category.php?op=updateAttributeGroup",e,{showLoading:!0})},remove:function(e){return o["hillo"].post("Category.php?op=deleteAttributeGroup",{id:e})}};t["a"]=o["IKDataEntity"].ModelFactory(u,l)},c5e4:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n("633c"),a={id:{type:r.IKDataEntity.Types.Integer,displayName:"id",tableConfig:{align:"start"},formConfig:{requiredNew:!1}},name:{displayName:"Name"},lang:{},desc:{displayName:"Beschreibung",formConfig:{required:!1}}},i=r.IKDataEntity.ModelFactory(a,{});t.default=i},ebc9:function(e,t,n){"use strict";var r=n("5530"),a=(n("96cf"),n("1da1")),i=n("3405"),o=n("633c"),u={id:{type:o["IKDataEntity"].Types.Integer,displayName:"id",tableConfig:{align:"start"},formConfig:{requiredNew:!1}},name:{},lang:{}},l={load:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,o["hillo"].get("CategoryType.php",Object(r["a"])({lang:i["a"].lang()},t));case 2:return e.abrupt("return",e.sent.content);case 3:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()};t["a"]=o["IKDataEntity"].ModelFactory(u,l)},ed28:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",{attrs:{fluid:""}},[n("v-card",[n("v-container",[n("v-row",[n("v-col",{attrs:{cols:"6"}},[n("v-dialog",{ref:"dialog",attrs:{"return-value":e.dates,persistent:"",width:"290px"},on:{"update:returnValue":function(t){e.dates=t},"update:return-value":function(t){e.dates=t}},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on,a=t.attrs;return[n("v-text-field",e._g(e._b({attrs:{label:"起止日期","prepend-icon":"mdi-calendar",readonly:""},model:{value:e.dates,callback:function(t){e.dates=t},expression:"dates"}},"v-text-field",a,!1),r))]}}]),model:{value:e.datePickerDialog,callback:function(t){e.datePickerDialog=t},expression:"datePickerDialog"}},[n("v-date-picker",{attrs:{range:"",scrollable:""},model:{value:e.dates,callback:function(t){e.dates=t},expression:"dates"}},[n("v-spacer"),n("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){e.datePickerDialog=!1}}},[e._v(" Cancel ")]),n("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){return e.$refs.dialog.save(e.dates)}}},[e._v(" OK ")])],1)],1)],1),n("v-col",{attrs:{cols:"6"}},[n("v-select",{attrs:{label:"隐藏属性","item-text":"name","item-value":"id",multiple:"",clearable:"",items:e.realAttributes},model:{value:e.hideAttributes,callback:function(t){e.hideAttributes=t},expression:"hideAttributes"}})],1)],1),n("v-row",[n("v-col",{attrs:{cols:"6"}},[n("v-select",{attrs:{label:"选择菜品(不选即为选择所有菜品)","item-text":"name","item-value":"id",multiple:"",items:e.displayData}})],1),n("v-col",{attrs:{cols:"6"}},[n("v-btn",{attrs:{disabled:e.tableData.length<2,"x-large":"",color:"primary",block:""},on:{click:function(t){e.showSalesTable=!0}}},[e._v(" 开整 ")])],1)],1)],1)],1),n("v-dialog",{attrs:{fullscreen:"",scrollable:""},model:{value:e.showSalesTable,callback:function(t){e.showSalesTable=t},expression:"showSalesTable"}},[n("v-card",[n("v-toolbar",{attrs:{dense:"",dark:""}},[n("v-toolbar-title",[e._v("销售统计")]),n("v-spacer"),n("v-icon",{on:{click:function(t){e.showSalesTable=!e.showSalesTable}}},[e._v(" mdi-close ")])],1),n("v-card-text",[n("v-data-table",{attrs:{"fixed-header":"",dense:"","hide-default-footer":"","disable-pagination":"",height:"calc(100vh - 72px)","item-class":e.computeClass,headers:e.headers,items:e.tableData,"items-per-page":100}})],1)],1)],1)],1)},a=[],i=(n("99af"),n("4de4"),n("7db0"),n("4160"),n("caad"),n("d81d"),n("13d5"),n("b0c0"),n("b680"),n("d3b7"),n("07ac"),n("2532"),n("159b"),n("ddb0"),n("5530")),o=(n("96cf"),n("1da1")),u=n("0a61"),l=n("591e"),c=n("2f69"),s=n("b0d9"),p=n("633c"),d={name:"SalesInsight",data:function(){return{datePickerDialog:null,dates:[],showSalesTable:null,displayData:[],attributeData:[],dishData:[],hideAttributes:[],mergedGroup:[],fixedHeader:[{text:"name",value:"name"},{text:"price",value:"price"},{text:"amount",value:"amount"}]}},computed:{headers:function(){return this.fixedHeader.concat(this.attributeHeader)},realAttributes:function(){return this.attributeData.reduce((function(e,t){return t.childAttributes.forEach((function(t){return e.push(t)})),e}),[])},attributeHeader:function(){var e=this;return this.realAttributes.filter((function(t){return!e.hideAttributes.includes(t.id)})).map((function(e){return e.text=e.name,e.value="attr"+e.id,e}))},tableData:function(){var e=[],t=function(e){return e.isDish=!0,e.name=e.code+"/"+e.name,e.price="".concat(e.originPrice," (avg:€").concat((e.totalPrice/e.totalCount).toFixed(2),")"),e.amount=e.totalCount,e.groupData.forEach((function(t){e["attr"+t.id]=t.count})),e},n=function(e,t){return e.name="v:"+t,e.amount=e.count,e.groupData.forEach((function(t){e["attr"+t.id]=t.count})),e};return this.displayData.forEach((function(r){e.push(t(r)),r.variants.forEach((function(t,r){e.push(n(t,r))}))})),e}},watch:{dates:function(e){this.loadSalesData(e)}},mounted:function(){this.loadData()},methods:{computeClass:function(e){return e.isDish?"dishRow normal":"normal"},groupElement:function(e,t){var n=function(n,r){var a=p["IKUtils"].deepCopy(n),i=function(n){return e.forEach((function(e){var i=a.find((function(n){return e[t]===n[r]}));i&&(i[n]||(i[n]=[]),i[n].push(e))})),a};return{saveIn:i}};return{on:n}},getAllAttribute:function(){return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c["a"].getList();case 2:return e.abrupt("return",e.sent.filter((function(e){return e.optattributeGroupId.length>0})));case 3:case"end":return e.stop()}}),e)})))()},getAttributeGrouped:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,s["a"].getList();case 2:return n=t.sent,t.next=5,e.getAllAttribute();case 5:return r=t.sent,t.abrupt("return",e.groupElement(r,"attributeGroupId").on(n,"id").saveIn("childAttributes"));case 7:case"end":return t.stop()}}),t)})))()},getSalesInfo:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var r,a,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,Object(u["z"])(e);case 2:if(r=n.sent,0!==r.length){n.next=5;break}return n.abrupt("return",[]);case 5:return a=Object(l["StandardDishesListFactory"])().formatList(r.content),i=a.reduce((function(e,t){var n=e[t.code];n?(n.totalCount+=t.count,n.totalPrice+=t.realPrice*t.count):(e[t.code]={categoryId:parseInt(t.categoryId),categoryTypeId:parseInt(t.categoryTypeId),code:t.code,name:t.name,totalCount:t.count,originPrice:t.originPrice,totalPrice:t.realPrice*t.count,variants:[]},n=e[t.code]);var r=n.variants.find((function(e){return e.identity===t.identity}));return r?r.count+=t.count:n.variants.push({identity:t.identity,count:parseInt(t.count),displayApply:t.displayApply,price:t.realPrice}),e}),{}),n.abrupt("return",Object.values(i).map((function(e){return e.group=t.groupAttribute(e),e})));case 8:case"end":return n.stop()}}),n)})))()},groupAttribute:function(e){var t=this;return e.groupData=p["IKUtils"].deepCopy(this.realAttributes),e.variants.forEach((function(n){n.groupData=p["IKUtils"].deepCopy(t.realAttributes),n.displayApply.forEach((function(t){var r=e.groupData.find((function(e){return e.id===parseInt(t.aId)})),a=n.groupData.find((function(e){return e.id===parseInt(t.aId)}));r&&a&&(a.count||(a.count=0),a.count++,r.count||(r.count=0),r.count++)}))})),e.variants.reduce((function(e,t){return t.displayApply.forEach((function(t){var n=e.find((function(e){return e.agId===t.agId}));n||(n=Object(i["a"])(Object(i["a"])({},t),{},{values:[]}),e.push(n));var r=n.values.find((function(e){return e.aId===t.aId}));r?r.count++:n.values.push(Object(i["a"])(Object(i["a"])({},t),{},{count:1}))})),e}),[])},loadSalesData:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var r,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.getSalesInfo(e);case 2:r=n.sent,a=r.reduce((function(e,t){return e.totalPrice+=t.totalPrice,e.groupData.forEach((function(e,n){var r;e.count||(e.count=0),e.count+=null!==(r=t.groupData[n].count)&&void 0!==r?r:0})),e.totalCount+=t.totalCount,e}),{code:"-",name:"Alle",totalPrice:0,originPrice:0,totalCount:0,groupData:p["IKUtils"].deepCopy(t.realAttributes),variants:[]}),t.displayData=[a].concat(r);case 5:case"end":return n.stop()}}),n)})))()},loadData:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getAttributeGrouped();case 2:e.attributeData=t.sent;case 3:case"end":return t.stop()}}),t)})))()}}},f=d,y=(n("32f5"),n("2877")),h=n("6544"),g=n.n(h),v=n("8336"),m=n("b0af"),b=n("99d9"),I=n("62ad"),O=n("a523"),w=n("8fea"),D=n("2e4b"),P=n("169a"),j=n("132d"),C=n("0fd9"),T=n("b974"),A=n("2fa4"),N=n("8654"),E=n("71d9"),x=n("2a7f"),K=Object(y["a"])(f,r,a,!1,null,null,null);t["default"]=K.exports;g()(K,{VBtn:v["a"],VCard:m["a"],VCardText:b["c"],VCol:I["a"],VContainer:O["a"],VDataTable:w["a"],VDatePicker:D["a"],VDialog:P["a"],VIcon:j["a"],VRow:C["a"],VSelect:T["a"],VSpacer:A["a"],VTextField:N["a"],VToolbar:E["a"],VToolbarTitle:x["a"]})},ee60:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n("4eed")),a=n("633c");function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t,n,r,a,i,o){try{var u=e[i](o),l=u.value}catch(c){return void n(c)}u.done?t(l):Promise.resolve(l).then(r,a)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){c(i,r,a,o,u,"next",e)}function u(e){c(i,r,a,o,u,"throw",e)}o(void 0)}))}}var p={id:{type:a.IKDataEntity.Types.Integer,displayName:"id",tableConfig:{align:"start"},formConfig:{requiredNew:!1}},name:{}},d={load:function(){var e=s((function*(e){return(yield a.hillo.get("Complex.php",u({op:"showAllConsumeTypeInfo",lang:r.default.lang()},e))).content}));function t(t){return e.apply(this,arguments)}return t}()},f=a.IKDataEntity.ModelFactory(p,d);t.default=f}}]);
//# sourceMappingURL=chunk-34ce26b4.bda3c91d.js.map