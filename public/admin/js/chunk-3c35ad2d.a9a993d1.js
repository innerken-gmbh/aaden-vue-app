(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3c35ad2d"],{4497:function(t,e,a){"use strict";a("4de4"),a("d81d"),a("96cf");var n=a("1da1"),i=a("633c"),r=a("6306"),s=a("9225"),o={list:[{id:"1",name:s["a"].t("Others")},{id:"2",name:s["a"].t("Rechnung")},{id:"3",name:s["a"].t("Zbon")}],getList:function(){return this.list}},c={list:[{id:"0",name:s["a"].t("打印失败")},{id:"1",name:s["a"].t("打印成功")},{id:"2",name:s["a"].t("验证错误")},{id:"3",name:s["a"].t("单子格式不合规范")},{id:"4",name:s["a"].t("正在打印")},{id:"5",name:s["a"].t("网络错误")}],getList:function(){return this.list}},l={id:{type:i["a"].Types.Integer,displayName:"id",tableConfig:{align:"start"}},printStatus:{displayName:"printStatus",type:i["a"].Types.Option,formConfig:{type:{selectItems:c.getList(),multiple:!0,itemText:"name"}}},addTimeStamp:{displayName:"addTimeStamp"},printBonClass:{type:i["a"].Types.Option,formConfig:{type:{selectItems:o.getList()}}},printerGroupId:{type:i["a"].Types.Option,formConfig:{type:{selectItems:r["a"].getList}}},printerMsg:{displayName:"printerMsg"},content:{displayName:"checkContent",header:!1}},d={load:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,i["e"].get("PrintRecord.php",{op:"getAllRecords"});case 2:if(a=t.sent.content.map((function(t){return i["a"].parseDataForEntity(t,l)})),e=e[0],!e){t.next=6;break}return t.abrupt("return",a.filter((function(t){return t.printStatus[0]!==e.printStatus})));case 6:return t.abrupt("return",a);case 7:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}(),reprint:function(t){return i["e"].get("Printer.php?op=reprintWithDefault",{id:t.id})}};e["a"]=i["a"].ModelFactory(l,d)},"5c3a8":function(t,e,a){"use strict";a.r(e),a.d(e,"getPrintList",(function(){return y}));var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{id:"dashboard",fluid:"",tag:"section"}},[a("v-row",[[a("v-col",{attrs:{cols:"12",lg:"3",sm:"6"}},[a("base-material-stats-card",{attrs:{color:"info",icon:"mdi-twitter","sub-icon":"mdi-clock","sub-text":t.$t("Just Updated"),title:t.$t("今日营业总额"),value:"€"+t.todayInfo.sumIncome}})],1),a("v-col",{attrs:{cols:"12",lg:"3",sm:"6"}},[a("base-material-stats-card",{attrs:{color:"primary",icon:"mdi-poll","sub-icon":"mdi-tag","sub-text":t.$t("Tracked from Aaden Analytics"),title:t.$t("今日用餐总人数"),value:t.todayInfo.sumPersonCount}})],1),a("v-col",{attrs:{cols:"12",lg:"3",sm:"6"}},[a("base-material-stats-card",{attrs:{color:"success",icon:"mdi-store","sub-icon":"mdi-calendar","sub-text":"",title:t.$t("使用中的桌子"),value:t.tableUsageStatus.inUse}})],1),a("v-col",{attrs:{cols:"12",lg:"3",sm:"6"}},[a("base-material-stats-card",{attrs:{color:"orange",icon:"mdi-sofa","sub-icon":"mdi-alert",title:t.$t("本月平均翻台率"),"sub-text":t.$t("翻台率是指桌子被使用的频率"),value:t.tableRenew.toFixed(2)+"%"}})],1)],a("v-row",{attrs:{justify:"space-around"}},[a("v-btn",{staticClass:"ma-4",attrs:{color:"green darken-2",dark:""},on:{click:t.toZbon}},[t._v(" Zbon Print "),a("v-icon",{attrs:{dark:"",right:""}},[t._v(" mdi-format-list-bulleted ")])],1),a("v-btn",{staticClass:"ma-4",attrs:{color:"blue darken-2",dark:""},on:{click:t.toAllBills}},[t._v(" see Rechnung "),a("v-icon",{attrs:{dark:"",right:""}},[t._v(" mdi-calendar-account ")])],1),a("v-btn",{staticClass:"ma-4",attrs:{color:"purple darken-2",dark:""},on:{click:t.addDishes}},[t._v(" add dishes "),a("v-icon",{attrs:{dark:"",right:""}},[t._v(" mdi-pencil ")])],1),a("v-btn",{staticClass:"ma-4",attrs:{color:"pink",dark:""},on:{click:t.addCategories}},[t._v(" add category "),a("v-icon",{attrs:{dark:"",right:""}},[t._v(" mdi-domain ")])],1),a("v-btn",{staticClass:"ma-4",attrs:{color:"teal darken-2",dark:""},on:{click:t.dishStatistic}},[t._v(" 菜品统计 "),a("v-icon",{attrs:{dark:"",right:""}},[t._v(" mdi-dialpad ")])],1),a("v-btn",{staticClass:"ma-4",attrs:{color:"orange darken-2",dark:""},on:{click:t.dailyBill}},[t._v(" 每日汇总 "),a("v-icon",{attrs:{dark:"",right:""}},[t._v(" mdi-bulletin-board ")])],1)],1),a("v-col",{attrs:{cols:"12",md:"12"}},[a("v-card",{attrs:{color:"basil"}},[a("v-card-title",{staticClass:"text-center justify-center py-6"},[a("h1",{staticClass:"font-weight-bold display-3 basil--text"},[t._v(t._s(t.restaurantName))])]),a("v-tabs",{attrs:{"background-color":"transparent",color:"basil",grow:""}},[t._l(t.items,(function(e,n){return a("v-tab",{key:n},[t._v(" "+t._s(e)+" ")])})),a("v-tab-item",[a("base-material-card",{staticClass:"px-5 py-3",attrs:{color:"red",icon:"mdi-truck",small:"",inline:""},scopedSlots:t._u([{key:"after-heading",fn:function(){return[a("div",{staticClass:"display-1 font-weight-light mt-2"},[t._v(" "+t._s(t.$t("等待处理的外卖订单"))+" ")])]},proxy:!0}])},[a("v-card-text",[a("v-data-table",{attrs:{headers:t.headers,items:t.desserts,"items-per-page":5,"sort-desc":["id"],"sort-by":["id"],"show-expand":"","multi-sort":""},scopedSlots:t._u([{key:"item.action",fn:function(e){var n=e.item;return[parseInt(n.consumeTypeStatusId)<2?[t._l([0,30,60,90],(function(e){return[a("v-chip",{key:e,staticClass:"mx-2",attrs:{color:"green","text-color":"white"},on:{click:function(a){return t.acceptOrder(n,e)}}},[t._v(" + "+t._s(e)+" MIN ")])]})),a("v-chip",{staticClass:"mr-2",attrs:{color:"red","text-color":"white"},on:{click:function(e){return t.rejectOrder(n)}}},[t._v(" "+t._s(t.$t("拒绝订单"))+" "),a("v-icon",{attrs:{small:"",right:""}},[t._v(" mdi-close-circle ")])],1)]:t._e(),void 0,a("v-chip",{staticClass:"mr-2",on:{click:function(e){return t.goNext(n)}}},[t._v(" "+t._s(t.$t("查看详情"))+" "),a("v-icon",{attrs:{small:"",right:""}},[t._v(" mdi-arrow-right ")])],1)]}},{key:"item.payMethod",fn:function(e){var a=e.item;return[t._v(" "+t._s(t.payMethods.find((function(t){return a.payMethod===t.id})).name)+" ")]}},{key:"item.consumeTypeStatusId",fn:function(e){var a=e.item;return[t._v(" "+t._s(t.statusText(a))+" ")]}},{key:"expanded-item",fn:function(e){var n=e.item;return[a("td",{attrs:{colspan:t.headers.length+1}},[a("v-card",{staticStyle:{width:"100%"}},[a("v-card-title",[t._v(t._s(t.$t("详细信息")))]),a("v-card-text",[a("v-row",[a("v-col",{attrs:{cols:"12",md:"6"}},[a("address-info-block",{attrs:{"address-info":JSON.parse(n.rawAddressInfo)}})],1),a("v-col",{attrs:{cols:"12",md:"6"}},[a("dish-info-block",{attrs:{"dish-orders":n.details}})],1)],1)],1)],1)],1)]}}])})],1)],1)],1),a("v-tab-item",[a("ik-data-table",{attrs:{model:t.model,"use-default-action":!1,"use-select":!1,"show-expand":!0,"single-expand":!0,filter:{printStatus:1},icon:"mdi-clipboard-list","items-per-page":5,"entity-name":t.$t("打印单列表")},scopedSlots:t._u([{key:"expanded-item",fn:function(e){var n=e.item;return[a("div",{staticClass:"text-center",domProps:{innerHTML:t._s(n.content)}})]}},{key:"footer",fn:function(){return[a("v-toolbar",{attrs:{color:"white",flat:""}})]},proxy:!0},{key:"item.action",fn:function(e){var n=e.item;return[a("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(e){return t.reprint(n)}}},[t._v(" mdi-printer ")])]}}])})],1),a("v-tab-item",[a("base-material-card",{staticClass:"px-5 py-3",attrs:{id:"coloured-line",color:"warning",icon:"mdi-chart-timeline-variant"},scopedSlots:t._u([{key:"after-heading",fn:function(){return[a("div",{staticClass:"display-1 font-weight-light mt-2"},[t._v(" "+t._s(t.$t("销售数据统计"))+" ")])]},proxy:!0}])},[a("chartist",{staticClass:"mt-3",staticStyle:{"max-height":"300px"},attrs:{data:t.salesData,options:t.salesDataChart.options,type:"Line"}}),a("v-divider",{staticClass:"ma-3"}),a("div",{staticClass:"px-3"},[a("div",{staticClass:"body-2 text-uppercase grey--text font-weight-bold mb-3"},[t._v(" Legend ")]),a("v-row",{staticClass:"ma-0",attrs:{align:"center"}},[a("v-avatar",{staticClass:"mr-1",attrs:{color:"info",size:"12"}}),a("span",{staticClass:"mr-3 font-weight-light"},[t._v(t._s(t.$t("Food")))]),a("v-avatar",{staticClass:"mr-1",attrs:{color:"red",size:"12"}}),a("span",{staticClass:"mr-3 font-weight-light"},[t._v(t._s(t.$t("Drinks")))])],1)],1)],1)],1),a("v-tab-item",[a("base-material-card",{staticClass:"px-5 py-3",attrs:{color:"primary",icon:"mdi-account",inline:""},scopedSlots:t._u([{key:"after-heading",fn:function(){return[a("div",{staticClass:"display-1 font-weight-light mt-2"},[t._v(" "+t._s(t.$t("随时更新，随时掌握营销状况"))+" ")])]},proxy:!0}])},[a("v-card-text",[a("v-data-table",{attrs:{headers:t.servantHeader,items:t.thisMonthServantRank},scopedSlots:t._u([{key:"item.photo",fn:function(e){var n=e.item;return[a("v-avatar",{attrs:{tile:""}},[a("v-img",{attrs:{src:t.servantImgRoot+n.photo,height:"48px",width:"48px"}})],1)]}}])})],1)],1)],1),a("v-tab-item",[a("v-row",[a("v-col",{attrs:{cols:"12",md:"8"}},[a("base-material-card",{staticClass:"px-5 py-3",attrs:{color:"red",inline:""},scopedSlots:t._u([{key:"heading",fn:function(){return[a("div",{staticClass:"display-2 font-weight-light"},[t._v(" "+t._s(t.$t("本周热销菜品"))+" ")]),a("div",{staticClass:"subtitle-1 font-weight-light"},[t._v(" "+t._s(t.$t("本周内最受欢迎的精美食品"))+" ")])]},proxy:!0}])},[a("v-card-text",[a("v-data-table",{attrs:{headers:t.dishesHeader,items:t.thisWeekMostPopularDishes},scopedSlots:t._u([{key:"item.photo",fn:function(e){var n=e.item;return[a("v-avatar",{attrs:{tile:""}},[a("v-img",{attrs:{src:t.dishImgRoot+n.image,height:"48px",width:"48px"}})],1)]}}])})],1)],1)],1),a("v-col",{attrs:{cols:"12",md:"4"}},[a("v-card",[a("v-card-title",{staticClass:"subheading font-weight-bold"},[t._v(" 热销菜品分布 ")]),a("v-divider"),a("v-list",{attrs:{dense:""}},t._l(t.indexData.thisMonthIncomePieChart,(function(e,n){return a("v-list-item",{key:n},[a("v-list-item-content",[t._v(" "+t._s(t.indexData.thisMonthIncomePieChart[n].name)+": ")]),a("v-list-item-content",[t._v(" "+t._s(t.indexData.thisMonthIncomePieChart[n].sumPrice)+" ")])],1)})),1)],1)],1)],1),t._v("> ")],1)],2)],1)],1)],2)],1)},i=[],r=(a("7db0"),a("c975"),a("a15b"),a("13d5"),a("b0c0"),a("ac1f"),a("1276"),a("b85c")),s=a("0a61"),o=a("3405"),c=a("f683"),l=a("4907"),d=a("ccdd"),u=a("0144"),h=a("c1df"),m=a.n(h),p=a("633c"),f=a("9225"),v=a("4497"),g={name:"DashboardDashboard",components:{DishInfoBlock:l["default"],AddressInfoBlock:c["default"],IkDataTable:p["c"]},data:function(){return{timer1:null,timer2:null,items:["外卖订单","失败打印单列表","销售数据统计","跑堂排行","本周热销菜品"],salesDataChart:{options:{low:0,chartPadding:{top:0,right:0,bottom:0,left:0}}},servantHeader:[{text:"Name",value:"name"},{text:this.$i18n.t("income"),value:"income",align:"right"},{text:this.$i18n.t("billCount"),value:"billCount",align:"right"}],dishesHeader:[{text:this.$i18n.t("Ranking"),value:"rank"},{text:this.$i18n.t("image"),value:"photo",align:"center"},{text:this.$i18n.t("name"),value:"name",align:"right"},{text:this.$i18n.t("price"),value:"price",align:"right"},{text:this.$i18n.t("count"),value:"sumCount",align:"right"}],indexData:{sevenDaysFoodDrinkIncome:[],thisMonthServantRank:[],todayInfo:{sumIncome:"0"},tableUsageStatus:{inUse:"0"},thisMonthAverageTablesRenewRate:0},headers:[{text:"Id",align:"start",value:"id"},{text:this.$i18n.t("下单时间"),value:"createTimestamp"},{text:this.$i18n.t("totalPrice"),value:"totalPrice"},{text:this.$i18n.t("payMethod"),value:"payMethod"},{text:this.$i18n.t("consumeTypeStatus"),value:"consumeTypeStatusId"},{text:this.$i18n.t("action"),value:"action",sortable:!1}],model:v["a"],desserts:[],payMethods:[],printList:[],consumeTypeStatusList:[],restaurantName:""}},computed:{filter:function(){return function(t){return"1"!==t.printStatus}},servantImgRoot:function(){return this.$store.getters.rootUrl+o["a"].servantRoot},dishImgRoot:function(){return this.$store.getters.rootUrl+o["a"].dishImageRoot},salesData:function(){var t,e=[],a=[],n=[],i=Object(r["a"])(this.indexData.sevenDaysFoodDrinkIncome);try{for(i.s();!(t=i.n()).done;){var s=t.value,o=s.find((function(t){return"foods"===t.name.toLowerCase()})),c=s.find((function(t){return"drinks"===t.name.toLowerCase()}));e.push(o.dateDisplay),a.push(o.income),n.push(c.income)}}catch(l){i.e(l)}finally{i.f()}return{labels:e.reverse(),series:[a.reverse(),n.reverse()]}},thisMonthServantRank:function(){return this.indexData.thisMonthServantRank},todayInfo:function(){return this.indexData.todayInfo},tableUsageStatus:function(){return this.indexData.tableUsageStatus},tableRenew:function(){return this.indexData.thisMonthAverageTablesRenewRate},thisWeekMostPopularDishes:function(){return this.indexData.thisWeekMostPopularDishes},totalSales:function(){return this.sales.reduce((function(t,e){return t+e.salesInM}),0)}},created:function(){this.onceData(),this.reloadData(),this.reloadItem(),this.timer2=setInterval(this.reloadItem,3e4),this.$once("hook:beforeDestroy",(function(){}))},beforeDestroy:function(){clearInterval(this.timer2)},methods:{toZbon:function(){this.$router.push({path:"/Bills/zbonlist"})},toAllBills:function(){this.$router.push({path:"/Bills/history-bills"})},addDishes:function(){this.$router.push({path:"/dishes/dishes-manage"})},addCategories:function(){this.$router.push({path:"/dishes/labels-manage"})},dishStatistic:function(){this.$router.push({path:"/dishes/dish-statistics"})},dailyBill:function(){this.$router.push({path:"/Bills/today-bills"})},statusText:function(t){return 1===parseInt(t.consumeTypeStatusId)?(console.log(["1","2","3"].indexOf(t.payMethod)),-1!==["1","2","3"].indexOf(t.payMethod)?"Unbezahlt":"Bezahlt"):this.consumeTypeStatusList.find((function(e){return t.consumeTypeStatusId===e.id})).name},acceptOrder:function(t,e){var a=this,n=JSON.parse(t.rawAddressInfo),i=m()();return n&&n.date&&n.time&&(i=m()(n.date+" "+n.time,"DD.MM.YYYY HH:mm")),i.add(e,"m"),u["a"].post("Orders.php?op=acceptTakeawayOrder",{tableId:t.tableId,reason:i.format("DD-MM-YYYY HH:mm")}).then((function(t){console.log(t),a.reloadItem()}))},rejectOrder:function(t){p["e"].fastSweetAlertRequest(this.$i18n.t("请输入拒绝接单的理由"),"text","Orders.php?op=rejectTakeAwayOrder","reason",{tableId:t.tableId},this.reloadItem)},goNext:function(t){this.$router.push({name:"Seite mit den Rechnungsdetails",params:{id:t.id}})},onceData:function(){var t=this;Object(s["h"])().then((function(e){t.payMethods=e.content,t.formatItem()})),Object(s["k"])().then((function(e){t.consumeTypeStatusList=e.content})),y().then((function(e){var a,n=Object(r["a"])(e.content);try{for(n.s();!(a=n.n()).done;){var i=a.value;"1"!==i.printStatus&&t.printList.push(i)}}catch(s){n.e(s)}finally{n.f()}})),Object(s["p"])().then((function(e){var a=[];a=e.content[0].name.split("<BR>"),t.restaurantName=a.join(" "),console.log("====="+t.restaurantName)}))},findLangInArray:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f["a"].locale;return t.find((function(t){return t.lang.toLowerCase()===e.toLowerCase()}))},formatItem:function(){var t,e=Object(r["a"])(this.payMethods);try{for(e.s();!(t=e.n()).done;){var a=t.value;a.name=this.findLangInArray(a.langs).name}}catch(n){e.e(n)}finally{e.f()}},reloadData:function(){var t=this;Object(s["n"])().then((function(e){t.indexData=e}))},reloadItem:function(){var t=this;this.loading=!0,Object(s["r"])().then((function(e){t.desserts.length>0&&e.content.length>t.desserts.length&&d["a"].play(),t.desserts=e.content,t.loading=!1}))},beforeDestroy:function(){clearTimeout(this.timer1),clearTimeout(this.timer2),this.timer1=null,this.timer2=null},complete:function(t){this.list[t]=!this.list[t]}}},y=function(t){return u["a"].get("PrintRecord.php?op=getAllRecords",{id:t})},b=g,k=(a("674b"),a("2877")),x=a("6544"),_=a.n(x),C=a("8212"),w=a("8336"),I=a("b0af"),S=a("99d9"),D=a("cc20"),$=a("62ad"),T=a("a523"),M=a("8fea"),R=a("ce7e"),O=a("132d"),P=a("adda"),L=a("8860"),N=a("da13"),V=a("5d23"),j=a("0fd9"),A=a("71a3"),B=a("c671"),U=a("fe57"),F=a("71d9"),H=Object(k["a"])(b,n,i,!1,null,null,null);e["default"]=H.exports;_()(H,{VAvatar:C["a"],VBtn:w["a"],VCard:I["a"],VCardText:S["c"],VCardTitle:S["d"],VChip:D["a"],VCol:$["a"],VContainer:T["a"],VDataTable:M["a"],VDivider:R["a"],VIcon:O["a"],VImg:P["a"],VList:L["a"],VListItem:N["a"],VListItemContent:V["a"],VRow:j["a"],VTab:A["a"],VTabItem:B["a"],VTabs:U["a"],VToolbar:F["a"]})},6306:function(t,e,a){"use strict";a("d81d");var n=a("5530"),i=(a("96cf"),a("1da1")),r=a("633c"),s={id:{type:r["a"].Types.Integer,displayName:"id",tableConfig:{align:"start"}},name:{displayName:"sectionName"},isSingleLinePrint:{type:r["a"].Types.Boolean,displayName:"isSingleLinePrint"},isSingleOrderPrint:{type:r["a"].Types.Boolean,displayName:"isSingleOrderPrint"},printerCount:{displayName:"printerCount",formConfig:{inEdit:!1,inNew:!1}}},o={load:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,r["e"].get("Printer.php",Object(n["a"])({op:"showPrinterGroups"},e));case 2:return t.abrupt("return",t.sent.content.map((function(t){return r["a"].parseDataForEntity(t,s)})));case 3:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}(),add:function(t){return r["e"].postWithUploadFile("Printer.php?op=addPrinterGroups",t,{showLoading:!0})},edit:function(t){return r["e"].postWithUploadFile("Printer.php?op=updatePrinterGroups",t,{showLoading:!0})},remove:function(t){return r["e"].post("Printer.php?op=deletePrinterGroup",{id:t})}};e["a"]=r["a"].ModelFactory(s,o)},"674b":function(t,e,a){"use strict";var n=a("d1f7"),i=a.n(n);i.a},d1f7:function(t,e,a){}}]);
//# sourceMappingURL=chunk-3c35ad2d.a9a993d1.js.map