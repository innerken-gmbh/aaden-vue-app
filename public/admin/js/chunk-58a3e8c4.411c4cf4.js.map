{"version":3,"sources":["webpack:///./src/model/Servant.js","webpack:///./src/model/PaymentColors.js","webpack:///./src/views/Bills/HistoryBills.vue?a4ac","webpack:///./src/model/HistoryBills.js","webpack:///src/views/Bills/HistoryBills.vue","webpack:///./src/views/Bills/HistoryBills.vue?6ddb","webpack:///./src/views/Bills/HistoryBills.vue"],"names":["entity","id","type","IKDataEntity","Types","Integer","displayName","tableConfig","align","form","photo","Image","formConfig","root","store","getters","rootUrl","GlobalSettings","servantRoot","requiredEdit","requiredNew","md","header","name","password","permission","Boolean","isPartTime","config","add","item","hillo","postWithUploadFile","showLoading","edit","file","imageExt","split","lastItem","remove","post","load","filter","get","lang","getLang","content","ModelFactory","list","color","getList","this","render","_vm","_h","$createElement","_c","_self","ref","staticStyle","attrs","model","dates","$t","scopedSlots","_u","key","fn","staticClass","_l","n","i","billSelectionColorList","on","$event","setBillDates","_v","_s","calculateTotalPaymentPrice","toFixed","print","proxy","goNext","value","callback","$$v","showDetail","expression","currentOrderId","staticRenderFns","orderId","disableNew","disableEdit","tableName","sortable","servantName","Option","selectItems","Servant","itemText","itemValue","totalPrice","payMethod","Payment","PaymentColors","merge","paymentStr","required","consumeTypeId","ConsumeType","paymentArr","multiple","disabledItem","disabled","updateTimestamp","timespan","dateFilter","join","paymentList","op","map","payLogs","forEach","paymentOriginalItem","find","p","parseInt","paymentMethodId","_langsname","amount","push","String","components","BillDetailPage","IkDataTable","data","timer","menu","modal","menu2","billSelectionList","mounted","methods","calculateTotalPrice","items","totalMoney","IKUtils","printSummaryBon","component","VBtn","VCard","VDialog","VIcon"],"mappings":"mPAKMA,EAAS,CACbC,GAAI,CACFC,KAAMC,kBAAaC,MAAMC,QACzBC,YAAa,KACbC,YAAa,CACXC,MAAO,SAETC,MAAM,GAERC,MAAO,CACLJ,YAAa,QACbJ,KAAMC,kBAAaC,MAAMO,MACzBC,WAAY,CACVV,KAAM,CACJW,KAAM,kBAAMC,OAAMC,QAAQC,QAAUC,OAAeC,cAErDC,cAAc,EACdC,aAAa,EACbC,GAAI,IAENC,QAAQ,GAEVC,KAAM,CACJjB,YAAa,eAEfkB,SAAU,GAEVC,WAAY,CACVvB,KAAMC,kBAAaC,MAAMsB,SAE3BC,WAAY,CACVzB,KAAMC,kBAAaC,MAAMsB,UAGvBE,EAAS,CACbC,IAAK,SAAUC,GACb,OAAOC,IAAMC,mBAAmB,qBAAsBF,EAAM,CAC1DG,aAAa,KAGjBC,KAAM,SAAUJ,GAId,OAHIA,EAAKK,OACPL,EAAKM,SAAWN,EAAKK,KAAKZ,KAAKc,MAAM,KAAKC,UAErCP,IAAMC,mBAAmB,wBAAyBF,EAAM,CAC7DG,aAAa,KAGjBM,OAAQ,SAAUtC,GAChB,OAAO8B,IAAMS,KAAK,wBAAyB,CAAEvC,GAAIA,KAEnDwC,KAAM,WAAF,4CAAE,WAAgBC,GAAhB,+FACUX,IAAMY,IAAI,cAAV,gBAA2BC,KAAM3B,OAAe4B,WAAcH,IADxE,uCAEDI,SAFC,2CAAF,sDAAE,IAMO3C,yBAAa4C,aAAa/C,EAAQ4B,I,kCC9DlC,QACboB,KAAM,CACJ,CACE/C,IAAK,GACLgD,MAAO,mBACN,CACDhD,IAAK,GACLgD,MAAO,yBAET,CACEhD,GAAI,EACJgD,MAAO,SAET,CACEhD,GAAI,EACJgD,MAAO,WACN,CACDhD,GAAI,EACJgD,MAAO,WACN,CACDhD,GAAI,EACJgD,MAAO,WACN,CACDhD,GAAI,EACJgD,MAAO,aACN,CACDhD,GAAI,EACJgD,MAAO,UACN,CACDhD,GAAI,EACJgD,MAAO,YACN,CACDhD,GAAI,EACJgD,MAAO,QACN,CACDhD,GAAI,EACJgD,MAAO,QACN,CACDhD,GAAI,EACJgD,MAAO,QACN,CACDhD,GAAI,GACJgD,MAAO,yBACN,CACDhD,GAAI,GACJgD,MAAO,QACN,CACDhD,GAAI,GACJgD,MAAO,eACN,CACDhD,GAAI,GACJgD,MAAO,SACN,CACDhD,GAAI,GACJgD,MAAO,UACN,CACDhD,GAAI,GACJgD,MAAO,eACN,CACDhD,GAAI,GACJgD,MAAO,kBACN,CACDhD,GAAI,GACJgD,MAAO,aACN,CACDhD,GAAI,GACJgD,MAAO,mBACN,CACDhD,GAAI,GACJgD,MAAO,mBACN,CACDhD,GAAI,GACJgD,MAAO,0BAGXC,QAAS,WACP,OAAOC,KAAKH,Q,2CC5EhB,IAAII,EAAS,WAAa,IAAIC,EAAIF,KAASG,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACA,EAAG,gBAAgB,CAACE,IAAI,YAAYC,YAAY,CAAC,MAAQ,QAAQC,MAAM,CAAC,sBAAqB,EAAM,MAAQP,EAAIQ,MAAM,sBAAsBR,EAAIS,MAAM,cAAcT,EAAIU,GAAG,QAAQ,cAAa,EAAM,4BAA2B,EAAK,KAAO,2BAA2B,mBAAkB,GAAMC,YAAYX,EAAIY,GAAG,CAAC,CAACC,IAAI,SAASC,GAAG,WAAW,MAAO,CAACX,EAAG,MAAM,CAACY,YAAY,eAAe,CAACf,EAAIgB,GAAIhB,EAAqB,mBAAE,SAASiB,EAAEC,GAAG,MAAO,CAACf,EAAG,QAAQ,CAACU,IAAIK,EAAEH,YAAY,OAAOR,MAAM,CAAC,MAAQP,EAAImB,uBAAuBD,GAAG,KAAO,GAAG,SAAW,GAAG,MAAQ,IAAIE,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOrB,EAAIsB,aAAaJ,MAAM,CAAClB,EAAIuB,GAAG,IAAIvB,EAAIwB,GAAGP,GAAG,WAAUd,EAAG,QAAQ,CAACY,YAAY,OAAOR,MAAM,CAAC,MAAQ,GAAG,MAAQ,UAAU,CAACP,EAAIuB,GAAG,IAAIvB,EAAIwB,GAAGxB,EAAIU,GAAG,cAAc,KAAKV,EAAIwB,GAAGxB,EAAIyB,6BAA6BC,QAAQ,IAAI,OAAOvB,EAAG,QAAQ,CAACY,YAAY,UAAUR,MAAM,CAAC,MAAQ,IAAIa,GAAG,CAAC,MAAQpB,EAAI2B,QAAQ,CAAC3B,EAAIuB,GAAG,IAAIvB,EAAIwB,GAAGxB,EAAIU,GAAG,OAAO,QAAQ,KAAKkB,OAAM,GAAM,CAACf,IAAI,cAAcC,GAAG,SAAST,GAC9jC,IAAI5B,EAAO4B,EAAI5B,KACf,MAAO,CAAC0B,EAAG,SAAS,CAACY,YAAY,OAAOR,MAAM,CAAC,MAAQ,IAAIa,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOrB,EAAI6B,OAAOpD,MAAS,CAACuB,EAAIuB,GAAG,8BAA8BpB,EAAG,WAAW,CAACI,MAAM,CAAC,WAAa,IAAIC,MAAM,CAACsB,MAAO9B,EAAc,WAAE+B,SAAS,SAAUC,GAAMhC,EAAIiC,WAAWD,GAAKE,WAAW,eAAe,CAAC/B,EAAG,SAAS,CAACI,MAAM,CAAC,MAAQ,YAAY,CAACJ,EAAG,MAAM,CAACY,YAAY,2BAA2B,CAACZ,EAAG,QAAQ,CAACI,MAAM,CAAC,MAAQ,SAASa,GAAG,CAAC,MAAQ,SAASC,GAAQrB,EAAIiC,YAAW,KAAS,CAAC9B,EAAG,SAAS,CAACI,MAAM,CAAC,MAAQ,QAAQ,KAAO,KAAK,CAACP,EAAIuB,GAAG,iBAAiBpB,EAAG,OAAO,CAACG,YAAY,CAAC,YAAY,SAAS,CAACN,EAAIuB,GAAGvB,EAAIwB,GAAGxB,EAAIU,GAAG,WAAW,IAAI,GAAGP,EAAG,mBAAmB,CAACI,MAAM,CAAC,GAAKP,EAAImC,mBAAmB,IAAI,IAAI,IACvrBC,EAAkB,G,oOCMhBzF,EAAS,CACb0F,QAAS,CACPxF,KAAMC,kBAAaC,MAAMC,QACzBC,YAAa,KACbC,YAAa,CACXC,MAAO,SAETI,WAAY,CACV+E,YAAY,EACZC,aAAa,EACbxE,aAAa,IAGjByE,UAAW,CACTtF,YAAa,CACXuF,UAAU,IAGdC,YAAa,CACX7F,KAAMC,kBAAaC,MAAM4F,OACzBpF,WAAY,CACVV,KAAM,CACJ+F,YAAaC,OAAQhD,QACrBiD,SAAU,OACVC,UAAW,SAGf9F,YAAa,eAGf+F,WAAY,CACV9F,YAAa,CACXuF,UAAU,IAGdQ,UAAW,CACTpG,KAAMC,kBAAaC,MAAM4F,OACzBpF,WAAY,CACVV,KAAM,CACJ+F,YAAaM,OAAQrD,QACrBiD,SAAU,aACVlD,MAAOuD,OAActD,WAEvBuD,OAAO,GAETnG,YAAa,QAGfoG,WAAY,CACV9F,WAAY,CACV+F,UAAU,GAEZrG,YAAa,aAEfsG,cAAe,CACb1G,KAAMC,kBAAaC,MAAM4F,OACzBpF,WAAY,CACVV,KAAM,CACJ+F,YAAaY,OAAY3D,WAI/B4D,WAAY,CACVxG,YAAa,YACbJ,KAAMC,kBAAaC,MAAM4F,OACzB1E,QAAQ,EACRV,WAAY,CACV+F,UAAU,EACVzG,KAAM,CACJ+F,YAAaM,OAAQrD,QAErB6D,UAAU,EACVC,aAAc,SAAClF,GACb,OAAgB,IAAZA,EAAK7B,GACA,eAAC,kBACH6B,GADL,IAEEmF,SAAUnF,IAGLA,MAMjBoF,gBAAiB,CACf5G,YAAa,SAIXsB,EAAS,CACba,KAAM,WAAF,4CAAE,WAAgBC,GAAhB,gGACEyE,EAAWzE,EAAO,GAAG0E,WAAWC,KAAK,OADvC,SAEsBd,OAAQrD,UAF9B,cAEEoE,EAFF,gBAGgBvF,IAAMY,IAAI,aAAc,CAC1C4E,GAAI,oBACJ3E,KAAM3B,OAAe4B,UACrBsE,SAAUA,IANR,cAGEnE,EAHF,OAOAF,QAPA,kBASGE,EAAKwE,KAAI,SAAU1F,GAmBxB,OAlBIA,EAAK2F,UACP3F,EAAK4E,WAAa,GAClB5E,EAAKgF,WAAa,GAClBhF,EAAK2F,QAAQC,SAAQ,SAAApD,GAEnB,GADAA,EAAEqD,oBAAsBL,EAAYM,MAAK,SAAAC,GAAC,OAAIA,EAAE5H,KAAO6H,SAASxD,EAAEyD,oBACxC,MAAtBzD,EAAEyD,gBAAyB,CAC7B,IAAIrB,EAAa,GACbpC,EAAEqD,sBACJjB,EAAapC,EAAEqD,oBAAoBK,WAAa,IAAM1D,EAAE2D,QAE1DnG,EAAK4E,WAAWwB,KAAKxB,GACrB5E,EAAKgF,WAAWoB,KAAK5D,EAAEyD,qBAG3BjG,EAAK4E,WAAa5E,EAAK4E,WAAWW,KAAK,OACvCvF,EAAKgF,WAAaqB,OAAOrG,EAAKgF,aAEhChF,EAAK7B,GAAK6B,EAAK4D,QACR5D,MA5BL,2CAAF,sDAAE,IAgCO3B,oBAAa4C,aAAa/C,EAAQ4B,G,iCCtCjD,GACAwG,YACAC,4BACAC,8BAEAC,gBACA,OAEA1E,QACAC,8DACA0E,WACAlD,gBACAE,oBACAiD,QACAC,SACAC,SACAC,mBACA,qBACA,qBACA,sBAEApE,qFAGAqE,QAxBA,WAwBA,oJACA,gEADA,8CAGAC,SACAC,oBADA,SACAC,GACA,mBACA,qBACAlH,yDACA,MAEAgD,2BAPA,WAOA,MACA,iEACA,qEACA,sDAKA,CACA,iDACA,IAYA,OAXAgC,uBAAA,IAAI,EAAJ,iBACAkC,GADA,IACA,0CACA,kBACAlH,+BACA,4CACAmH,6BALA,kCAWA,EAlBA,mBACA,qBACAnH,yDACA,MAkBAoD,OAhCA,SAgCApD,GACA,mBACA,+BAEA6C,aApCA,SAoCAJ,GACA,UACA,OACA,mEACA,MACA,OACA,mFACA,MACA,OACA,oFACA,MACA,OACA,qFAIAS,MApDA,WAsDA,OAAAmC,mDACA+B,qFACAC,mCACAD,2CClLqW,I,iFCOjWE,EAAY,eACd,EACAhG,EACAqC,GACA,EACA,KACA,KACA,MAIa,aAAA2D,EAAiB,QAQhC,IAAkBA,EAAW,CAACC,OAAA,KAAKC,QAAA,KAAMC,UAAA,KAAQC,QAAA","file":"js/chunk-58a3e8c4.411c4cf4.js","sourcesContent":["import GlobalSettings from '@/GlobalSettings'\r\nimport store from '../store'\r\nimport { IKDataEntity } from 'metaflow-js'\r\nimport hillo from 'hillo'\r\n\r\nconst entity = {\r\n  id: {\r\n    type: IKDataEntity.Types.Integer,\r\n    displayName: 'id',\r\n    tableConfig: {\r\n      align: 'start',\r\n    },\r\n    form: false,\r\n  },\r\n  photo: {\r\n    displayName: 'image',\r\n    type: IKDataEntity.Types.Image,\r\n    formConfig: {\r\n      type: {\r\n        root: () => store.getters.rootUrl + GlobalSettings.servantRoot,\r\n      },\r\n      requiredEdit: false,\r\n      requiredNew: false,\r\n      md: 12,\r\n    },\r\n    header: false,\r\n  },\r\n  name: {\r\n    displayName: 'servantName',\r\n  },\r\n  password: {\r\n  },\r\n  permission: {\r\n    type: IKDataEntity.Types.Boolean,\r\n  },\r\n  isPartTime: {\r\n    type: IKDataEntity.Types.Boolean,\r\n  },\r\n}\r\nconst config = {\r\n  add: function (item) {\r\n    return hillo.postWithUploadFile('Servant.php?op=add', item, {\r\n      showLoading: true,\r\n    })\r\n  },\r\n  edit: function (item) {\r\n    if (item.file) {\r\n      item.imageExt = item.file.name.split('.').lastItem\r\n    }\r\n    return hillo.postWithUploadFile('Servant.php?op=update', item, {\r\n      showLoading: true,\r\n    })\r\n  },\r\n  remove: function (id) {\r\n    return hillo.post('Servant.php?op=delete', { id: id })\r\n  },\r\n  load: async function (filter) {\r\n    return (await hillo.get('Servant.php', { lang: GlobalSettings.getLang(), ...filter }))\r\n      .content\r\n  },\r\n}\r\n\r\nexport default IKDataEntity.ModelFactory(entity, config)\r\n","export default {\r\n  list: [\r\n    {\r\n      id: -11,\r\n      color: 'brown lighten-5',\r\n    }, {\r\n      id: -10,\r\n      color: 'deep-orange lighten-5',\r\n    },\r\n    {\r\n      id: 0,\r\n      color: 'error',\r\n    },\r\n    {\r\n      id: 1,\r\n      color: 'primary',\r\n    }, {\r\n      id: 2,\r\n      color: 'success',\r\n    }, {\r\n      id: 3,\r\n      color: 'warning',\r\n    }, {\r\n      id: 4,\r\n      color: 'secondary',\r\n    }, {\r\n      id: 5,\r\n      color: 'accent',\r\n    }, {\r\n      id: 6,\r\n      color: 'tertiary',\r\n    }, {\r\n      id: 7,\r\n      color: 'info',\r\n    }, {\r\n      id: 8,\r\n      color: 'pink',\r\n    }, {\r\n      id: 9,\r\n      color: 'cyan',\r\n    }, {\r\n      id: 10,\r\n      color: 'deep-purple lighten-4',\r\n    }, {\r\n      id: 11,\r\n      color: 'lime',\r\n    }, {\r\n      id: 12,\r\n      color: 'light-green',\r\n    }, {\r\n      id: 13,\r\n      color: 'amber',\r\n    }, {\r\n      id: 14,\r\n      color: 'yellow',\r\n    }, {\r\n      id: 15,\r\n      color: 'deep-orange',\r\n    }, {\r\n      id: 16,\r\n      color: 'blue lighten-4',\r\n    }, {\r\n      id: 17,\r\n      color: 'blue-grey',\r\n    }, {\r\n      id: 18,\r\n      color: 'yellow darken-4',\r\n    }, {\r\n      id: 19,\r\n      color: 'brown lighten-5',\r\n    }, {\r\n      id: 20,\r\n      color: 'deep-orange lighten-5',\r\n    },\r\n  ],\r\n  getList: function () {\r\n    return this.list\r\n  },\r\n}\r\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('ik-data-table',{ref:\"billTable\",staticStyle:{\"width\":\"100%\"},attrs:{\"use-default-action\":false,\"model\":_vm.model,\"required-date-value\":_vm.dates,\"entity-name\":_vm.$t('全部账单'),\"use-select\":false,\"use-customer-action-only\":true,\"icon\":'mdi-format-list-bulleted',\"use-date-filter\":true},scopedSlots:_vm._u([{key:\"footer\",fn:function(){return [_c('div',{staticClass:\"d-flex pa-2\"},[_vm._l((_vm.billSelectionList),function(n,i){return [_c('v-btn',{key:i,staticClass:\"mr-1\",attrs:{\"color\":_vm.billSelectionColorList[i],\"dark\":\"\",\"outlined\":\"\",\"small\":\"\"},on:{\"click\":function($event){return _vm.setBillDates(i)}}},[_vm._v(\" \"+_vm._s(n)+\" \")])]}),_c('v-btn',{staticClass:\"ml-1\",attrs:{\"small\":\"\",\"color\":\"green\"}},[_vm._v(\" \"+_vm._s(_vm.$t('sumAmount'))+\"：€\"+_vm._s(_vm.calculateTotalPaymentPrice().toFixed(2))+\" \")]),_c('v-btn',{staticClass:\"primary\",attrs:{\"small\":\"\"},on:{\"click\":_vm.print}},[_vm._v(\" \"+_vm._s(_vm.$t('打印'))+\" \")])],2)]},proxy:true},{key:\"item.action\",fn:function(ref){\nvar item = ref.item;\nreturn [_c('v-icon',{staticClass:\"mr-2\",attrs:{\"small\":\"\"},on:{\"click\":function($event){return _vm.goNext(item)}}},[_vm._v(\" mdi-arrow-right \")])]}}])}),_c('v-dialog',{attrs:{\"fullscreen\":\"\"},model:{value:(_vm.showDetail),callback:function ($$v) {_vm.showDetail=$$v},expression:\"showDetail\"}},[_c('v-card',{attrs:{\"color\":\"#f6f6f6\"}},[_c('div',{staticClass:\"d-flex justify-end py-8\"},[_c('v-btn',{attrs:{\"color\":\"error\"},on:{\"click\":function($event){_vm.showDetail=false}}},[_c('v-icon',{attrs:{\"color\":\"white\",\"left\":\"\"}},[_vm._v(\" mdi-close \")]),_c('span',{staticStyle:{\"font-size\":\"24px\"}},[_vm._v(_vm._s(_vm.$t('返回')))])],1)],1),_c('bill-detail-page',{attrs:{\"id\":_vm.currentOrderId}})],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import GlobalSettings from '@/GlobalSettings'\r\n\r\nimport { IKDataEntity } from 'metaflow-js'\r\nimport hillo from 'hillo'\r\nimport ConsumeType from './ConsumeType'\r\nimport Payment from './Payment'\r\nimport PaymentColors from './PaymentColors'\r\nimport Servant from '@/model/Servant'\r\n\r\nconst entity = {\r\n  orderId: {\r\n    type: IKDataEntity.Types.Integer,\r\n    displayName: 'id',\r\n    tableConfig: {\r\n      align: 'start',\r\n    },\r\n    formConfig: {\r\n      disableNew: true,\r\n      disableEdit: true,\r\n      requiredNew: false,\r\n    },\r\n  },\r\n  tableName: {\r\n    tableConfig: {\r\n      sortable: true,\r\n    },\r\n  },\r\n  servantName: {\r\n    type: IKDataEntity.Types.Option,\r\n    formConfig: {\r\n      type: {\r\n        selectItems: Servant.getList,\r\n        itemText: 'name',\r\n        itemValue: 'name',\r\n      },\r\n    },\r\n    displayName: 'servantName',\r\n  },\r\n\r\n  totalPrice: {\r\n    tableConfig: {\r\n      sortable: true,\r\n    },\r\n  },\r\n  payMethod: {\r\n    type: IKDataEntity.Types.Option,\r\n    formConfig: {\r\n      type: {\r\n        selectItems: Payment.getList,\r\n        itemText: '_langsname',\r\n        color: PaymentColors.getList(),\r\n      },\r\n      merge: false,\r\n    },\r\n    displayName: '付款状态',\r\n\r\n  },\r\n  paymentStr: {\r\n    formConfig: {\r\n      required: false,\r\n    },\r\n    displayName: 'payMethod',\r\n  },\r\n  consumeTypeId: {\r\n    type: IKDataEntity.Types.Option,\r\n    formConfig: {\r\n      type: {\r\n        selectItems: ConsumeType.getList,\r\n      },\r\n    },\r\n  },\r\n  paymentArr: {\r\n    displayName: 'payMethod',\r\n    type: IKDataEntity.Types.Option,\r\n    header: false,\r\n    formConfig: {\r\n      required: false,\r\n      type: {\r\n        selectItems: Payment.getList,\r\n        // itemText: '_langsname',\r\n        multiple: true,\r\n        disabledItem: (item) => {\r\n          if (item.id === 0) {\r\n            return ({\r\n              ...item,\r\n              disabled: item,\r\n            })\r\n          } else {\r\n            return item\r\n          }\r\n        },\r\n      },\r\n    },\r\n  },\r\n  updateTimestamp: {\r\n    displayName: '结账时间',\r\n  },\r\n}\r\n\r\nconst config = {\r\n  load: async function (filter) {\r\n    const timespan = filter[0].dateFilter.join(' - ')\r\n    const paymentList = await Payment.getList()\r\n    const list = (await hillo.get('Orders.php', {\r\n      op: 'withSortAndFilter',\r\n      lang: GlobalSettings.getLang(),\r\n      timespan: timespan,\r\n    })).content\r\n\r\n    return list.map(function (item) {\r\n      if (item.payLogs) {\r\n        item.paymentStr = []\r\n        item.paymentArr = []\r\n        item.payLogs.forEach(n => {\r\n          n.paymentOriginalItem = paymentList.find(p => p.id === parseInt(n.paymentMethodId))\r\n          if (n.paymentMethodId !== '9') {\r\n            let paymentStr = ''\r\n            if (n.paymentOriginalItem) {\r\n              paymentStr = n.paymentOriginalItem._langsname + ':' + n.amount\r\n            }\r\n            item.paymentStr.push(paymentStr)\r\n            item.paymentArr.push(n.paymentMethodId)\r\n          }\r\n        })\r\n        item.paymentStr = item.paymentStr.join(' / ')\r\n        item.paymentArr = String(item.paymentArr)\r\n      }\r\n      item.id = item.orderId\r\n      return item\r\n    })\r\n  },\r\n}\r\nexport default IKDataEntity.ModelFactory(entity, config)\r\n","<template>\r\n  <div>\r\n    <ik-data-table\r\n      ref=\"billTable\"\r\n      :use-default-action=\"false\"\r\n      :model=\"model\"\r\n      :required-date-value=\"dates\"\r\n      :entity-name=\"$t('全部账单')\"\r\n      style=\"width: 100%\"\r\n      :use-select=\"false\"\r\n      :use-customer-action-only=\"true\"\r\n      :icon=\"'mdi-format-list-bulleted'\"\r\n      :use-date-filter=\"true\"\r\n    >\r\n      <template #footer>\r\n        <div class=\"d-flex pa-2\">\r\n          <template v-for=\"(n, i) in billSelectionList\">\r\n            <v-btn\r\n              :key=\"i\"\r\n              class=\"mr-1\"\r\n              :color=\"billSelectionColorList[i]\"\r\n              dark\r\n              outlined\r\n              small\r\n              @click=\"setBillDates(i)\"\r\n            >\r\n              {{ n }}\r\n            </v-btn>\r\n          </template>\r\n\r\n          <v-btn\r\n            class=\"ml-1\"\r\n            small\r\n            color=\"green\"\r\n          >\r\n            {{ $t('sumAmount') }}：€{{ calculateTotalPaymentPrice().toFixed(2) }}\r\n          </v-btn>\r\n          <v-btn\r\n            small\r\n            class=\"primary\"\r\n            @click=\"print\"\r\n          >\r\n            {{ $t('打印') }}\r\n          </v-btn>\r\n        </div>\r\n      </template>\r\n      <template #item.action=\"{ item }\">\r\n        <v-icon\r\n          class=\"mr-2\"\r\n          small\r\n          @click=\"goNext(item)\"\r\n        >\r\n          mdi-arrow-right\r\n        </v-icon>\r\n      </template>\r\n    </ik-data-table>\r\n    <v-dialog\r\n      v-model=\"showDetail\"\r\n      fullscreen\r\n    >\r\n      <v-card\r\n        color=\"#f6f6f6\"\r\n      >\r\n        <div class=\"d-flex justify-end py-8\">\r\n          <v-btn\r\n            color=\"error\"\r\n            @click=\"showDetail=false\"\r\n          >\r\n            <v-icon\r\n              color=\"white\"\r\n              left\r\n            >\r\n              mdi-close\r\n            </v-icon>\r\n            <span style=\"font-size: 24px\">{{ $t('返回') }}</span>\r\n          </v-btn>\r\n        </div>\r\n\r\n        <bill-detail-page :id=\"currentOrderId\"/>\r\n      </v-card>\r\n    </v-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n\r\n  import { printSummaryBon } from '@/components/Utlis/api'\r\n  import IKUtils from 'innerken-js-utils'\r\n  import HistoryBills from '../../model/HistoryBills'\r\n  import { IkDataTable } from 'metaflow-js'\r\n  // import moment from 'moment'\r\n  import BillDetailPage from '../Details/BillDetailPage'\r\n  import dayjs from 'dayjs'\r\n\r\n  export default {\r\n    components: {\r\n      BillDetailPage,\r\n      IkDataTable,\r\n    },\r\n    data: function () {\r\n      return ({\r\n\r\n        model: HistoryBills,\r\n        dates: [dayjs().format('YYYY-MM-DD'), dayjs().format('YYYY-MM-DD')],\r\n        timer: null,\r\n        showDetail: null,\r\n        currentOrderId: null,\r\n        menu: false,\r\n        modal: false,\r\n        menu2: false,\r\n        billSelectionList: [\r\n          this.$i18n.t('当日结单'),\r\n          this.$i18n.t('本周结单'),\r\n          this.$i18n.t('本月结单'),\r\n        ],\r\n        billSelectionColorList: ['green darken-2', 'blue darken-2', 'purple darken-2', 'pink'],\r\n      })\r\n    },\r\n    async mounted () {\r\n      this.dates = [dayjs().format('YYYY-MM-DD'), dayjs().format('YYYY-MM-DD')]\r\n    },\r\n    methods: {\r\n      calculateTotalPrice (items) {\r\n        return items ? items.reduce(\r\n          (arr, item) =>\r\n            item.consumeTypeStatusId !== 5 ? arr + parseFloat(item.totalPrice) : arr\r\n          , 0) : 0\r\n      },\r\n      calculateTotalPaymentPrice () {\r\n        const items = this.$refs.billTable?.tableItem\r\n        if (!this.$refs.billTable || !this.$refs.billTable.filterItem.paymentArr ||\r\n          (this.$refs.billTable.filterItem.paymentArr.length === 0)) {\r\n          return items ? items.reduce(\r\n            (arr, item) =>\r\n              item.consumeTypeStatusId !== 5 ? arr + parseFloat(item.totalPrice) : arr\r\n            , 0) : 0\r\n        } else {\r\n          const paymentArr = this.$refs.billTable.filterItem.paymentArr\r\n          let totalMoney = 0\r\n          paymentArr.forEach(indexItem => {\r\n            for (const item of items) {\r\n              if (item.payLogs !== null) {\r\n                item.payLogs.forEach(payItem => {\r\n                  if (parseInt(payItem.paymentMethodId) === parseInt(indexItem)) {\r\n                    totalMoney += parseFloat(payItem.amount)\r\n                  }\r\n                })\r\n              }\r\n            }\r\n          })\r\n          return totalMoney\r\n        }\r\n      },\r\n      goNext (item) {\r\n        this.showDetail = true\r\n        this.currentOrderId = item.orderId\r\n      },\r\n      setBillDates (i) {\r\n        switch (i) {\r\n          case 0:\r\n            this.dates = [dayjs().format('YYYY-MM-DD'), dayjs().format('YYYY-MM-DD')]\r\n            break\r\n          case 1:\r\n            this.dates = [dayjs().startOf('week').format('YYYY-MM-DD'), dayjs().format('YYYY-MM-DD')]\r\n            break\r\n          case 2:\r\n            this.dates = [dayjs().startOf('month').format('YYYY-MM-DD'), dayjs().format('YYYY-MM-DD')]\r\n            break\r\n          case 3:\r\n            this.dates = [dayjs().startOf('year').format('YYYY-MM-DD'), dayjs().format('YYYY-MM-DD')]\r\n        }\r\n      },\r\n\r\n      print () {\r\n        // console.log('this.dates.', this.dates)\r\n        const timeSpan = { timespan: this.$refs.billTable.okDates.join(' - ') }\r\n        IKUtils.showConfirm('Bist du sicher?', 'Möchten Sie alle Datensätze drucken?', () => {\r\n          printSummaryBon(timeSpan).then(() => {\r\n            IKUtils.toast('Erfolgreich drucken!')\r\n          })\r\n        })\r\n      },\r\n\r\n    },\r\n  }\r\n</script>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./HistoryBills.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./HistoryBills.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./HistoryBills.vue?vue&type=template&id=48a1c0d6&\"\nimport script from \"./HistoryBills.vue?vue&type=script&lang=js&\"\nexport * from \"./HistoryBills.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VDialog } from 'vuetify/lib/components/VDialog';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\ninstallComponents(component, {VBtn,VCard,VDialog,VIcon})\n"],"sourceRoot":""}