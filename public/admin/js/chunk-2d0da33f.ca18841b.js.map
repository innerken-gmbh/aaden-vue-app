{"version":3,"sources":["webpack:///./src/views/TakeawaySetting/TakeawayList.vue?2e2b","webpack:///src/views/TakeawaySetting/TakeawayList.vue","webpack:///./src/views/TakeawaySetting/TakeawayList.vue?e35a","webpack:///./src/views/TakeawaySetting/TakeawayList.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","staticClass","scopedSlots","_u","key","fn","_v","_s","$t","proxy","headers","desserts","loading","ref","item","parseInt","consumeTypeStatusId","_l","time","on","$event","acceptOrder","rejectOrder","_e","goNext","payMethods","find","i","payMethod","id","name","statusText","length","staticStyle","JSON","parse","rawAddressInfo","details","staticRenderFns","findLangInArray","langs","component","VCard","VCardText","VCardTitle","VChip","VCol","VContainer","VDataTable","VIcon","VRow"],"mappings":"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","file":"js/chunk-2d0da33f.ca18841b.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-container',{attrs:{\"fluid\":\"\"}},[_c('base-material-card',{staticClass:\"px-5 py-3\",attrs:{\"color\":\"red\",\"icon\":\"mdi-truck\",\"small\":\"\",\"inline\":\"\"},scopedSlots:_vm._u([{key:\"after-heading\",fn:function(){return [_c('div',{staticClass:\"display-1 font-weight-light mt-2\"},[_vm._v(\" \"+_vm._s(_vm.$t('外卖单列表'))+\" \")])]},proxy:true}])},[_c('v-card-text',[_c('v-data-table',{attrs:{\"headers\":_vm.headers,\"items\":_vm.desserts,\"loading\":_vm.loading,\"items-per-page\":5,\"sort-desc\":['id'],\"sort-by\":['id'],\"show-expand\":\"\",\"multi-sort\":\"\"},scopedSlots:_vm._u([{key:\"item.action\",fn:function(ref){\nvar item = ref.item;\nreturn [(parseInt(item.consumeTypeStatusId)<2)?[_vm._l(([0,30,60,90]),function(time){return [_c('v-chip',{key:time,staticClass:\"mx-2\",attrs:{\"color\":\"green\",\"text-color\":\"white\"},on:{\"click\":function($event){return _vm.acceptOrder(item,time)}}},[_vm._v(\" + \"+_vm._s(time)+\" MIN \")])]}),_c('v-chip',{staticClass:\"mr-2\",attrs:{\"color\":\"red\",\"text-color\":\"white\"},on:{\"click\":function($event){return _vm.rejectOrder(item)}}},[_vm._v(\" \"+_vm._s(_vm.$t('拒绝订单'))+\" \"),_c('v-icon',{attrs:{\"small\":\"\",\"right\":\"\"}},[_vm._v(\" mdi-close-circle \")])],1)]:_vm._e(),void 0,_c('v-chip',{staticClass:\"mr-2\",on:{\"click\":function($event){return _vm.goNext(item)}}},[_vm._v(\" \"+_vm._s(_vm.$t('查看详情'))+\" \"),_c('v-icon',{attrs:{\"small\":\"\",\"right\":\"\"}},[_vm._v(\" mdi-arrow-right \")])],1)]}},{key:\"item.payMethod\",fn:function(ref){\nvar item = ref.item;\nreturn [_vm._v(\" \"+_vm._s(_vm.payMethods.find(function (i){ return item.payMethod===i.id; }).name)+\" \")]}},{key:\"item.consumeTypeStatusId\",fn:function(ref){\nvar item = ref.item;\nreturn [_vm._v(\" \"+_vm._s(_vm.statusText(item))+\" \")]}},{key:\"expanded-item\",fn:function(ref){\nvar item = ref.item;\nreturn [_c('td',{attrs:{\"colspan\":_vm.headers.length+1}},[_c('v-card',{staticStyle:{\"width\":\"100%\"}},[_c('v-card-title',[_vm._v(_vm._s(_vm.$t('详细信息')))]),_c('v-card-text',[_c('v-row',[_c('v-col',{attrs:{\"cols\":\"12\",\"md\":\"6\"}},[_c('address-info-block',{attrs:{\"address-info\":JSON.parse(item.rawAddressInfo)}})],1),_c('v-col',{attrs:{\"cols\":\"12\",\"md\":\"6\"}},[_c('dish-info-block',{attrs:{\"dish-orders\":item.details}})],1)],1)],1)],1)],1)]}}])})],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <v-container\n    fluid\n  >\n    <base-material-card\n      class=\"px-5 py-3\"\n      color=\"red\"\n      icon=\"mdi-truck\"\n      small\n      inline\n    >\n      <template v-slot:after-heading>\n        <div class=\"display-1 font-weight-light mt-2\">\n          {{ $t('外卖单列表') }}\n        </div>\n      </template>\n      <v-card-text>\n        <v-data-table\n          :headers=\"headers\"\n          :items=\"desserts\"\n          :loading=\"loading\"\n          :items-per-page=\"5\"\n          :sort-desc=\"['id']\"\n          :sort-by=\"['id']\"\n          show-expand\n          multi-sort\n        >\n          <template v-slot:item.action=\"{ item }\">\n            <template v-if=\"parseInt(item.consumeTypeStatusId)<2\">\n              <template\n                v-for=\"(time) in [0,30,60,90]\"\n              >\n                <v-chip\n                  :key=\"time\"\n                  class=\"mx-2\"\n                  color=\"green\"\n                  text-color=\"white\"\n                  @click=\"acceptOrder(item,time)\"\n                >\n                  + {{ time }} MIN\n                </v-chip>\n              </template>\n              <v-chip\n                class=\"mr-2\"\n                color=\"red\"\n                text-color=\"white\"\n                @click=\"rejectOrder(item)\"\n              >\n                {{ $t('拒绝订单') }}\n                <v-icon\n                  small\n                  right\n                >\n                  mdi-close-circle\n                </v-icon>\n              </v-chip>\n            </template>\n            <template/>\n            <v-chip\n              class=\"mr-2\"\n              @click=\"goNext(item)\"\n            >\n              {{ $t('查看详情') }}\n              <v-icon\n                small\n                right\n              >\n                mdi-arrow-right\n              </v-icon>\n            </v-chip>\n          </template>\n          <template v-slot:item.payMethod=\"{ item }\">\n            {{ payMethods.find(i=>item.payMethod===i.id).name }}\n          </template>\n          <template v-slot:item.consumeTypeStatusId=\"{ item }\">\n            {{ statusText(item) }}\n          </template>\n          <template v-slot:expanded-item=\"{ item }\">\n            <td :colspan=\"headers.length+1\">\n              <v-card style=\"width: 100%\">\n                <v-card-title>{{ $t('详细信息') }}</v-card-title>\n                <v-card-text>\n                  <v-row>\n                    <v-col\n                      cols=\"12\"\n                      md=\"6\"\n                    >\n                      <address-info-block :address-info=\"JSON.parse(item.rawAddressInfo)\"/>\n                    </v-col>\n                    <v-col\n                      cols=\"12\"\n                      md=\"6\"\n                    >\n                      <dish-info-block :dish-orders=\"item.details\"/>\n                    </v-col>\n                  </v-row>\n                </v-card-text>\n              </v-card>\n            </td>\n          </template>\n        </v-data-table>\n      </v-card-text>\n    </base-material-card>\n  </v-container>\n</template>\n\n<script>\n  import { getAllPayment, getConsumeTypeStatusList, getTakeawayOrder } from '../../components/Utlis/api'\n  import Utils from '../../components/Utlis/Utils'\n  import moment from 'moment'\n  import http from '../../components/Utlis/http'\n  import { hillo } from 'innerken-utils'\n  import i18n from '../../i18n'\n\n  export default {\n    props: {\n      id: {\n        default: -1,\n        type: Number,\n      },\n    },\n    data: function () {\n      return {\n        timer2: null,\n        loading: true,\n        search: '',\n        headers: [\n          {\n            text: 'Id',\n            align: 'start',\n            value: 'id',\n          },\n          {\n            text: this.$i18n.t('下单时间'),\n            value: 'createTimestamp',\n          },\n          {\n            text: this.$i18n.t('totalPrice'),\n            value: 'totalPrice',\n          },\n          {\n            text: this.$i18n.t('payMethod'),\n            value: 'payMethod',\n          },\n          {\n            text: this.$i18n.t('consumeTypeStatus'),\n            value: 'consumeTypeStatusId',\n          },\n          {\n            text: this.$i18n.t('action'),\n            value: 'action',\n            sortable: false,\n          },\n        ],\n        desserts: [],\n        payMethods: [],\n        consumeTypeStatusList: [],\n      }\n    },\n    beforeDestroy () {\n      clearInterval(this.timer2)\n    },\n    created () {\n      getAllPayment().then(res => {\n        this.payMethods = res.content\n        this.formatItem()\n      })\n      getConsumeTypeStatusList().then(res => {\n        this.consumeTypeStatusList = res.content\n      })\n      this.reloadItem()\n      this.timer2 = setInterval(this.reloadItem, 5000)\n      this.$once('hook:beforeDestroy', () => {})\n    },\n    methods: {\n      findLangInArray (langArray, target = i18n.locale) {\n        return langArray.find((item) => {\n          return item.lang.toLowerCase() === target.toLowerCase()\n        })\n      },\n      formatItem () {\n        for (const i of this.payMethods) {\n          i.name = this.findLangInArray(i.langs).name\n        }\n      },\n      statusText: function (item) {\n        if (parseInt(item.consumeTypeStatusId) === 1) {\n          if (['1', '2', '3'].indexOf(item.payMethod) !== -1) {\n            return 'Unbezahlt'\n          } else {\n            return 'Bezahlt'\n          }\n        } else {\n          return this.consumeTypeStatusList.find(i => item.consumeTypeStatusId === i.id).name\n        }\n      },\n      acceptOrder (item, time) {\n        const addressInfo = JSON.parse(item.rawAddressInfo)\n        let timeReal = moment()\n        if (addressInfo) {\n          if (addressInfo.date && addressInfo.time) {\n            timeReal = moment(addressInfo.date + ' ' + addressInfo.time, 'DD.MM.YYYY HH:mm')\n          }\n        }\n        timeReal.add(time, 'm')\n\n        return http.post('Orders.php?op=acceptTakeawayOrder', {\n          tableId: item.tableId,\n          reason: timeReal.format('DD-MM-YYYY HH:mm'),\n        })\n\n          .then(response => {\n            console.log(response)\n            this.reloadItem()\n          })\n      },\n      rejectOrder (item) {\n        hillo.fastSweetAlertRequest(this.$i18n.t('请输入拒绝接单的理由'), 'text', 'Orders.php?op=rejectTakeAwayOrder', 'reason', { tableId: item.tableId }, this.reloadItem)\n      },\n      reloadItem () {\n        getTakeawayOrder().then(res => {\n          this.desserts = res.content\n          if (this.desserts.find(d => d.consumeTypeStatusId < 2)) {\n            let count = 50\n            const r = () => {\n              count--\n              Utils.play()\n              if (count > 0) {\n                setTimeout(r, 100)\n              }\n            }\n            r()\n          }\n          this.loading = false\n        })\n      },\n      beforeDestroy () {\n        clearTimeout(this.timer2)\n        this.timer2 = null\n      },\n      goNext (item) {\n        this.$router.push({\n          name: 'Seite mit den Rechnungsdetails',\n          params: { id: item.id },\n        })\n      },\n    },\n  }\n</script>\n\n<style scoped>\n\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vuetify-loader/lib/loader.js??ref--18-0!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TakeawayList.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vuetify-loader/lib/loader.js??ref--18-0!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TakeawayList.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./TakeawayList.vue?vue&type=template&id=d5b7b870&scoped=true&\"\nimport script from \"./TakeawayList.vue?vue&type=script&lang=js&\"\nexport * from \"./TakeawayList.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"d5b7b870\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCardText } from 'vuetify/lib/components/VCard';\nimport { VCardTitle } from 'vuetify/lib/components/VCard';\nimport { VChip } from 'vuetify/lib/components/VChip';\nimport { VCol } from 'vuetify/lib/components/VGrid';\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VDataTable } from 'vuetify/lib/components/VDataTable';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\nimport { VRow } from 'vuetify/lib/components/VGrid';\ninstallComponents(component, {VCard,VCardText,VCardTitle,VChip,VCol,VContainer,VDataTable,VIcon,VRow})\n"],"sourceRoot":""}